*************************************************
How To: Generate Bonus Coupon Codes Automatically
*************************************************

CS-Cart allows you to generate coupon codes for customers automatically. Customers receive those codes by email and can use them at checkout to get various bonuses, such as free products, free shipping, discounts, and so on. To generate coupon codes automatically, we will need to create two promotions:

* The first promotion will provide bonuses if a generated coupon code is entered at checkout.

* The second promotion will generate coupon codes for the first promotion.

  .. important::

      Customers can't use coupon codes in the orders they receive these codes for.
      
================================
Step 1. Create a Discount Coupon
================================

A discount coupon is a :doc:`cart promotion <index>` that gives bonuses to the customers who enter the coupon code at checkout.

#. In the Administration panel, go to **Marketing → Promotions**.

#. Click the **+** button in the top right corner and choose **Add cart promotion**.

#. Fill in the required fields on the **General** tab. Make sure your promotion has a **Name**, and that the **Status** is set to *Active*.

#. Switch to the **Conditions** tab.

#. Click the **Add condition** button and select the **Automatically generated coupon codes** condition from the dropdown list.

   .. note::

       You'll see *No data found* next to the condition. It means that no coupon codes have been generated yet. These codes will be generated by the promotion we'll set up in step 2.

#. Click **Add condition** again and select the **Once per customer** condition from the dropdown list. That way a customer will be able to use a coupon code only once.

   .. image:: img/auto_coupon.png
       :align: center
       :alt: The conditions you add determine when customers can use coupon codes.

#. Switch to the **Bonuses** tab.

#. Click the **Add bonus** button and choose the desired bonus from the list.

#. Click the **Create** button.

=====================================================
Step 2. Create a Promotion that Provides Coupon Codes
=====================================================

A coupon alone isn't enough. You also need to generate coupon codes with a separate :doc:`cart promotion <index>`.

#. Go to **Marketing → Promotions**.

#. Click the **+** button in the top right corner and choose **Add cart promotion**.

#. Fill in the required fields on the **General** tab. Make sure your promotion has a **Name**, and that the **Status** is set to *Active*.

#. Switch to the **Conditions** tab.

#. Click the **Add condition** button and select the desired condition from the dropdown list.

   For example, choose **Order subtotal**, then select *equal or greater*, and enter *90* in the input field. Then customers will receive the coupon code only if their order subtotal is equal or greater than 90 units in the primary currency of your store.

#. Click **Add condition** again and select the **Once per customer** condition from the dropdown list. That way only one coupon code will be generated for a customer.

   .. image:: img/auto_coupon_02.png
       :align: center
       :alt: The conditions you add determine when coupon codes are generated.

#. Open the **Bonuses** tab and click the **Add bonus** button.

#. Select the **Give coupon** bonus from the dropdown list, then choose the promotion you created in step 1. This will generate a code for the selected coupon when the conditions are met.

#. Click the **Create** button.

   .. image:: img/auto_coupon_01.png
       :align: center
       :alt: The Give coupon bonus means that the coupon code will be generated and sent to customer.

Now customers will see a popup when they add a product to cart and become eligible for the promotion. They can find their coupon code in the order details. 

.. image:: img/free_shipping_coupon.png
    :align: center
    :alt: Customers can receive coupon code by email or find it in the order details.

.. important::

    The code won't work and won't be sent to the customer by email until the status of the order is set to *Complete*.

.. hint::

    Administrators can see the discount coupon codes generated for an order. To do it, go to **Orders → View orders**, select one of the orders, and switch to the **Promotions** tab. However, the code will work only if it appears on the list of automatically generated coupon codes on the **Conditions** tab of the promotion we created in step 1. 
