****************
Модуль "Janrain"
****************

Модуль использует платформу Janrain и позволяет пользователям входить в учетную запись магазина с помощью провайдеров Open ID.

.. hint::

    Помимо прочих способов интеграции с различными сервисами и социальными сетями, :doc:`можно встроить свой магазин на страницу Facebook. <../../look_and_feel/layouts/widget_mode/facebook_app>`

=========================
Описание работы с модулем
=========================

1. Установите модуль Janrain (:doc:`см. "Установка модулей" </user_guide/addons/1manage_addons>`).

2. Введите **API ключ** и **домен приложения (application domain)** в настройках модуля. Узнать их можно в `панели администратора Janrain Engage <https://dashboard.janrain.com/>`_ после `создания приложения <http://developers.janrain.com/how-to/social-login/create-a-social-login-application/>`_.

3. После включения и настройки аддона при входе на сайт добавляется кнопка "Авторизация через социальную сеть с помощью Janrain". Если ее нажать, появится всплывающее окно с выбором провайдера Open ID. Вид окна и доступные провайдеры настраиваются в `панели администратора Janrain Engage. <https://dashboard.janrain.com/>`_

   После выбора провайдера и успешного логина пользователь может быть возвращен на:
      
   * страницу редактирования профиля (если пользователь вошел в учетную запись в первый раз). На этой странице ползователь может заполнить все недостающие поля.

   * страницу, с которой пользователь вошел в учетную запись (если пользователь входит в учетную запись не первый раз).

======================
Техническая информация
======================

При установке аддона создается новое поле **janrain_identifier** в таблице ``users``. В это поле записывается уникальный идентификатор который мы получаем от Janrain. В дальнейшем пользователь будет идентифицироваться по этому полю.

После входа в учетную запись с помощью провайдера Open ID создается новый пользователь в базе данных и автоматически заполняются доступные поля (как правило это адрес электронной почты, имя, фамилия и др.). После входа в учетную запись пользователь может изменять эти поля.

Если пользователь укажет пароль и логин, то он наряду с Open ID сможет так же использовать обычную систему логинов.

Если у пользователя несколько логинов Open ID (например, учетные записи Google, Facebook, Twitter), и везде прописан одинаковый адрес электронной почты, то пользователь сможет использовать только один из них для работы в магазине. Если он попробует войти в учетную запись с другим Open ID, в котором используется тот же адрес электронной почты, то получит сообщение об ошибке.

