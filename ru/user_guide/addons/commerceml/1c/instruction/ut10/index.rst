************************************************************
1С УТ 10.3: Как настроить обмен данными c интернет-магазином
************************************************************

Инструкция по обмену данными в формате CommerceML между 1С "Управление Торговлей" 10.3 и интернет-магазином на платформе CS-Cart или маркетплейсом на платформе Multi-Vendor.

.. important::

    У 1С много разных версий и конфигураций, которые могут выглядеть по-разному. Поэтому мы на примере одной из версий описываем общий принцип настройки, чтобы вы по аналогии могли настроить свою версию 1C. Если там нет какого-то элемента управления или сильно отличается внешний вид, рекомендуем обратиться в техподдержку 1С.

.. contents::
    :local: 
    :depth: 2


Шаг 1. Подключение 1С УТ 10.3 к CS-Cart или Multi-Vendor
========================================================

Обмен данными запускается со стороны 1С, через так называемый узел обмена данными. Поэтому сначала нужно настроить этот узел и подключить к магазину.

#. В 1С перейдите в меню "Сервис" → "Обмен данными с WEB-сайтом" → "Настроить обмен данными с WEB-сайтом".

   .. fancybox:: img/image10_004.png
       :alt: Обмен данными 1C и CS-Cart

#. В окне "Настройка обмена данными с WEB-сайтом" введите:

   * Адрес сайта — адрес скрипта в магазине, который будет обрабатывать выгружаемые файлы. Его можно увидеть в настройках обмена на стороне CS-Cart; обычно он выглядит наподобие https://example.com/commerceml.

   * Пользователь — логин администратора магазина, у которого есть права для обмена.

   * Пароль — пароль администратора магазина.

     .. note::

         После заполнения полей проверьте, выполняется ли соединение. Для этого нажмите на кнопку "Проверить".

     .. fancybox:: img/image10_005.png
         :alt: Обмен данными 1C и CS-Cart

#. После ввода данных для соединения нажмите на кнопку "Далее". На шаге заполнения классификатора номенклатуры ничего заполнять не нужно, нажмите на кнопку "Далее".

   .. fancybox:: img/image10_006.png
        :alt: Обмен данными 1C и CS-Cart

#. Вы можете задать отбор (указать условия, по которым будет выгружаться номенклатура). Также вы можете указать, какие данные товара будут выгружаться.

   .. fancybox:: img/image10_007.png
        :alt: Обмен данными 1C и CS-Cart

#. Заполните настройки для обмена заказами.

    .. fancybox:: img/image10_008.png
        :alt: Обмен данными 1C и CS-Cart

#. Заполните настройки для загружаемых заказов.

    .. fancybox:: img/image10_009.png
        :alt: Обмен данными 1C и CS-Cart

#. Укажите режим обмена данными.

    .. fancybox:: img/image10_010.png
        :alt: Обмен данными 1C и CS-Cart

#. Если необходимо выполнять обмен по расписанию, то укажите, когда необходимо запускать обмен. 

    .. fancybox:: img/image10_011.png
        :alt: Обмен данными 1C и CS-Cart


Шаг 2. Настройка на стороне CS-Cart и Multi-Vendor
==================================================

Запустите обмен на стороне 1С. Когда 1С отправляет данные в CS-Cart или в Multi-Vendor в первый раз, то никакие товары ещё не создаются. Чтобы создавались, сначала нужно :doc:`задать соответствия и настройки на стороне CS-Cart </user_guide/addons/commerceml/index>`. Данные в CS-Cart начнут создаваться только после того, как будет задано хотя бы одно соответствие для каждой из нужных сущностей.

.. fancybox:: /user_guide/addons/commerceml/img/commerceml-checklist.png
    :alt: Список сущностей, для которых нужно задать соответствия в CS-Cart


Шаг 3. Запуск регулярного обмена данными между 1C УТ 10.3 и магазином
=====================================================================

После того, как CS-Cart настроен, последующие обмены с 1С начнут создавать в нём данные. Осталось только регулярно их выполнять. Обмен данными между 1С и CS-Cart можно осуществлять одним из способов:

* Автоматический запуск

  Для автоматического запуска обмена достаточно настроить расписание в узле обмена данными.

* Ручной запуск

  Для запуска обмена данными откройте созданный узел обмена и нажмите на кнопку "Выполнить обмен". Будет запущен процесс обмена, по окончании которого появится соответствующее сообщение.

.. fancybox:: img/image10_022.png
   :alt: Обмен данными 1C и CS-Cart

Для анализа результатов обмена используется журнал регистрации «1С: Предприятия». Для просмотра событий выгрузки данных в окне созданного узла обмена нажмите кнопку "Действия" → "Монитор обменов". Откроется окно "Монитор настроек обмена данными".
    
.. fancybox:: img/image10_023.png
    :alt: Обмен данными 1C и CS-Cart