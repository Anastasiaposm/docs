****************************************
Как настроить модуль “Рейтинг продавцов”
****************************************

.. contents::
    :local:
    
Основные настройки
==================

#. Установите модуль :doc:`/user_guide/addons/vendor_rating/index` так же, как и :doc:`любой другой модуль </user_guide/addons/1manage_addons>`.

#. Щёлкните по названию модуля, чтобы открыть его настройки.

#. На вкладке **Общее** настройте формулу, по которой будет рассчитываться рейтинг продавцов.

   Формула рейтинга может складываться из следующих показателей:
   
   * ``paidOrdersCount`` — количество заказов продавца со статусом **Обработан** и **Выполнен**.
   
   * ``paidOrdersTotal`` — сумма заказов продавца со статусом **Обработан** и **Выполнен**.
   
   * ``activeProductsCount`` — количество активных товаров продавца со статусом **Вкл.**.
   
   * ``manualVendorRating`` — рейтинг продавца, заданный вручную. Перейдите на вкладку **Рейтинг** на странице **Продавцы → Продавцы**, чтобы ввести этот показатель. Допустимое значение показателя — от *0* до *100*.
   
   * ``vendorReviewsRating`` — средняя оценка из одобренных отзывов о продавце.
   
   * ``productReviewsRating`` — средняя оценка из одобренных отзывов о товарах.
   
   * ``manualVendorPlanRating`` — рейтинг тарифного плана, заданный вручную. Перейдите на страницу **Продавцы → Тарифные планы для продавцов**. Щёлкните по названию тарифного плана, чтобы открыть его настройки, и перейдите на вкладку **Рейтинг**. Укажите значение рейтинга. Допустимое значение показателя — от *0* до *100*.
   
    • ``returnsCount`` — количество запросов на возврат, которые поступили продавцу.
    
    .. important::
    
        Переменные ``productReviewsRating``, ``manualVendorPlanRating`` и ``returnsCount`` доступны, только если у вас установлены модули :doc:`/user_guide/addons/comments_and_reviews/index`, :doc:`/user_guide/addons/vendor_plans/index` и “Возврат товаров” соответственно.
        
#. Укажите **Дату начала периода расчёта**. В рейтинг попадут только заказы, продукты и отзывы, созданные после указанного срока.

#. Нажмите **Сохранить**, затем **Запустить перерасчёт**.

   .. fancybox:: img/rating_general_settings.png
       :alt: Вкладка Общее настроек модуля Рейтинг продавцов
       
   .. hint::

       Для того, чтобы перерасчёт рейтинга не нарушил стабильность работы вашего магазина, рекомендуем настроить его автоматический перерасчет на момент наименьшей посещаемости магазина (к примеру, на ночное время). Укажите в `cron <http://ru.wikipedia.org/wiki/Cron>`_ время выполнения перерасчёта и добавьте команду:
       
       ``php /path/to/cart/admin.php -p --dispatch=vendor_rating.recalculate``

Как присвоить продавцу уровень рейтинга
=======================================

#. Откройте настройки модуля.

#. Перейдите на вкладку **Диапазоны рейтинга**.

#. Установите **Нижние границы рейтинга**. Значения устанавливаются в процентах, где *100%* — самое высокое значение рейтинга среди продавцов. 

#. Нажмите **Сохранить**.

   .. fancybox:: img/rating_ranges.png
       :alt: Вкладка Диапазоны рейтинга настроек модуля Рейтинг продавцов

Как добавить сортировку товаров по рейтингу
===========================================

Чтобы дать покупателям возможность сортировать товары и продавцов на витрине по рейтингу:

#. Откройте страницу **Настройки → Внешний вид**.

#. В разделе **Настройки вида списка товаров** поставьте галочку напротив **Сортировать по рейтингу продавца**.

#. Нажмите **Сохранить**.

   .. fancybox:: img/enable_sort_by_rating.png
       :alt: Включение настройки сортировки по рейтингу



