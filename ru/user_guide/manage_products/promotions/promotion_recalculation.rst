**************************************************************
Как отключить перерасчет промо-акций при редактировании заказа
**************************************************************

.. important::

    Инструкции из статьи подходят только для **CS-Cart 4.5.1 и более новых версий**.

При :doc:`редактировании заказа </user_guide/orders/actions_on_orders/order_details>` в CS-Cart  промо-акции к заказу применяются по тем правилам, которые существуют на момент редактирования заказа. Так работают все версии 4.x.x вплоть до 4.5.1

Начиная с CS-Cart 4.5.1, можно выбрать, пересчитывать ли промо-акции при редактировании заказа. Это поведение зависит от настройки в файле **config.local.php**, который лежит в папке с установленным CS-Cart. 

==========================
При установке 4.5.1 с нуля
==========================

После установки CS-Cart 4.5.1 или более новой версии с нуля, в файле **config.local.php** уже будет следующая строка::

  'do_not_apply_promotions_on_order_update' => true,

Эта строка означает, что промо-акции при редактировании заказа пересчитываться не будут. Старые промо-акции останутся применены к заказу.

=======================
При обновлении до 4.5.1
=======================

Если обновиться до CS-Cart 4.5.1 с более ранней версии, то в файле **config.local.php** не будет строки, указанной выше. Это нужно, чтобы поведение магазина не менялось неожиданно для владельца.

Поэтому после обновления промо-акции при редактировании заказа все еще будут пересчитываться автоматически:

* Выключенные или уже удаленные промо-акции к заказу не применятся. 

* Включенные промо-акции, созданные уже после размещения заказа, могут примениться, если заказ соответствует условиям промо-акций.

Чтобы отключить автоматический перерасчет промо-акций, откройте файл **config.local.php** добавьте туда в раздел ``$config['tweaks']`` строку, которая приведена выше. Выглядеть результат должен примерно так::

  $config['tweaks'] = array (
      '...' => ...,
      'do_not_apply_promotions_on_order_update' => true,
      '...' => ...,
  );
