****************************************************
Как автоматически генерировать коды бонусных купонов
****************************************************

CS-Cart позволяет автоматически генерировать коды для бонусных купонов. Покупатели получат коды по электронной почте и смогут использовать их при оформлении заказа, чтобы получить какой-либо бонус (товар в подарок, бесплатную доставку, скидку и т.п.). Чтобы генерировать коды автоматически, создадим две промо-акции:

* Первая промо-акция будет предоставлять бонусы, если покупатель введет сгенерированный код при оформлении заказа.

* Вторая промо-акция будет генерировать коды купонов для первой промо-акции.

  .. important::

      Покупатели не смогут использовать код в заказе, за который они этот код получили.

====================
Шаг 1. Создаём купон
====================

Купон — это :doc:`промо-акция для корзины <index>`. Покупатели получают бонусы при оформлении заказа, если введут код купона.

#. Откройте страницу **Маркетинг → Промо-акции и скидки** в панели администратора.

#. Нажмите кнопку **+** в правом верхнем углу и выберите вариант **Добавить промо-акцию для корзины**.

#. Заполните поля на вкладке **Общее**. Обязательно задайте **Название** и убедитесь, что выбран **Статус** *Вкл*.

#. Перейдите на вкладку **Условия**.

#. Нажмите кнопку **Добавить условие** и выберите в выпадающем списке вариант **Автоматически сгенерированные коды купонов**.

   .. note::

       Рядом с условием вы увидите надпись *Здесь пока ничего нет*. Это означает, что пока коды для купона не создавались. Эти коды будут создаваться промо-акцией, которую мы настроим в шаге 2.

#. Снова нажмите **Добавить условие** и выберите в выпадающем списке вариант **Один раз для покупателя**. Так покупатель сможет использовать код купона только один раз.

   .. fancybox:: img/auto_coupon.png
       :alt: Условия определяют, когда покупатели смогут использовать код купона.

#. Перейдите на вкладку **Бонусы**.

#. Нажмите кнопку **Добавить бонус** и выберите в выпадающем списке любой бонус.

#. Нажмите кнопку **Создать**.

==========================================================
Шаг 2. Создаём промо-акцию, которая генерирует коды купона
==========================================================

Недостаточно просто создать купон. Нужно ещё автоматически сгенерировать коды купона с помощью отдельной :doc:`промо-акции для корзины <index>`.

#. Откройте страницу **Маркетинг → Промо-акции и скидки** в панели администратора.

#. Нажмите кнопку **+** в правом верхнем углу и выберите вариант **Добавить промо-акцию для корзины**.

#. Заполните поля на вкладке **Общее**. Обязательно задайте **Название** и убедитесь, что выбран **Статус** *Вкл*.

#. Перейдите на вкладку **Условия**.

#. Нажмите кнопку **Добавить условие** и выберите в выпадающем списке любое подходящее условие.

   Например, выберем условие **Предварительная стоимость заказа**, поставим *больше или равно* и введем *90*. Тогда покупатель получит код купона, только если сумма заказа будет 90 единиц (в базовой валюте магазина) или выше.

#. Снова нажмите **Добавить условие** и выберите в выпадающем списке вариант **Один раз для покупателя**. Так для одного покупателя будет сгенерирован только один код купона.

   .. fancybox:: img/auto_coupon_02.png
       :alt: Добавленные вами условия определяют, как генерируются купоны

#. Перейдите на вкладку **Бонусы** и нажмите кнопку **Добавить бонус**.

#. Выберите вариант **Предоставить купон** в выпадающем списке. Затем выберите промо-акцию, которую мы создали в шаге 1. Теперь коды для первой промо-акции будут генерироваться автоматически, когда выполняются условия второй промо-акции.

#. Нажмите кнопку **Создать**.

   .. fancybox:: img/auto_coupon_01.png
       :alt: Бонус "Предоставить купон" означает, что код купона будет сгенерирован и отправлен покупателю.

Теперь покупатели увидят всплывающее сообщение, когда они добавят товары в корзину и будут подпадать под условия промо-акции. Код купона они смогут найти на странице с информацией о заказе.

.. fancybox:: img/free_shipping_coupon.png
    :alt: Покупатели получают коды по почте или находят их на странице заказа.

.. important::

    Код не сработает и не будет отправлен покупателю по электронной почте, пока статус заказа не изменится на *Выполнен*.

.. hint::

    Администратор может узнать, какой код был сгенерирован для заказа. Для этого нужно открыть один из заказов на странице **Заказы → Все заказы** и перейти на вкладку **Промо-акции**. Но код сработает, только если он есть в списке кодов на вкладке **Условия** у промо-акции, которую мы создали в шаге 1.
