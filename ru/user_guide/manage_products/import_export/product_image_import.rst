*************************************
Как импортировать изображения товаров
*************************************

Есть два способа импортировать изображения товаров в CS-Cart:

* **Администрирование → Импорт данных → Товары**: позволяет импортировать сами товары, а также их основные изображения.

* **Администрирование → Импорт данных → Товары → Изображения**: позволяет импортировать основные и дополнительные изображения для уже существующих товаров.

.. important::

    Для обоих способов нужен правильно отформатированный CSV-файл. В большинстве случаев вам понадобится сначала загрузить изображения на сервер, и только потом вы сможете их импортировать.


.. _upload-images-for-import:

============================
Способы загрузки изображений
============================

Перед тем, как вы сможете импортировать изображения, вам понадобится загрузить их. Для этого вы можете использовать:

* любой FTP-клиент;

* встроенный **Редактор файлов**.

---------------
Редактор файлов
---------------

Допустим, мы хотим загрузить изображения для товаров. Эти изображения будут использоваться при импорте, поэтому мы добавим их в раздел **Служебные файлы**, в отдельную папку *images*. Для этого:

#. Создайте архив **images.zip**. Так после распаковки архива на сервере будет создана папка *images*.

#. Откройте страницу **Администрирование → Файлы** в панели администратора CS-Cart.

#. Нажмите на **Служебные файлы**, а затем перетащите архив с изображениями в область с файлами.

#. Нажмите на архив правой кнопкой мыши и выберите **Распаковать архив**.

   Теперь у нас есть папка *images*, и мы можем ссылаться на изображения из неё в импортируемом CSV-файле.

   .. fancybox:: img/file_editor.png
       :alt: Редактор файлов в CS-Cart поддерживает drag-and-drop. Действия над файлами можно выполнять с помощью контекстного меню или кнопок сверху.

----------
FTP-клиент
----------

Если вы используете FTP-клиент, загрузите изображения в папку *var/files/[число]*. Именно там хранятся **Служебные файлы**.

.. note::

    Вместо *[число]* будет идентификатор одной из витрин. Поэтому, если вы хотите добавить служебный файл для первой витрины (или если у вас только одна витрина), путь будет таким: *var/files/1*.

.. hint::

    **Пользовательские файлы** хранятся в папках *images/companies/[число]*. 

========================================
Как сослаться на изображение в CSV-файле
========================================

Есть несколько вариантов, как указать CS-Cart, где искать изображение.

* **Вариант 1.** Ссылка на изображение, например ``http://www.example.com/test_image.jpg``.
 
  Ссылка не обязательно должна вести в ваш магазин — вы можете загрузить изображения на какой-нибудь сервис хранения файлов, а затем использовать ссылки оттуда. При импорте изображения будут загружены на сервер магазина.

* **Вариант 2.** Абсолютный путь из корневой директорий сервера до изображения. Например: ``/path/to/cs-cart/var/files/1/test_image.jpg``.

.. important::

    Для вариантов 3 и 4 понадобится загрузить изображения в раздел **Служебные файлы** или в его подпапки, :ref:`как описано выше <upload-images-for-import>`.

* **Вариант 3.** Относительный путь до файла с изображением из раздела **Служебные файлы**. Например: ``images/test_image.jpg``.

* **Вариант 4.** Только название файла: ``test_image.jpg``.

  В этом случае также понадобится указать относительный путь до изображений из раздела **Служебные файлы**. Но в отличие от варианта 3, вам понадобится сделать это в панели администратора CS-Cart: при импорте есть специальное поле **Директория с изображениями**.

  Если вы храните изображения прямо в директории **Служебные файлы**, то оставьте поле **Директория с изображениями** пустым.

.. note::

    Если вы используете вариант 1 - 3, то значение поля **Директория с изображениями** игнорируется.

.. fancybox:: img/images_directory.png
    :alt: Если вы хотите указывать только названия изображений в импортируемом CSV-файле, то заполните поле "Директория с изображениями" при импорте.

.. hint::

   Также вы можете задать альтернативный текст для изображений. Он задаётся после названия изображения, например: ``test_image.jpg#{[de]:ALT TEXT;[en]:ALT TEXT;}``.

===========================
Примеры импорта изображений
===========================

---------------------------------------------------------
Пример 1: Импорт товаров вместе с основными изображениями
---------------------------------------------------------

.. important::

    В этом случае дополнительные изображения товаров нужно будет импортировать отдельно.

#. Подготовьте изображения товаров и загрузите их куда нужно.

   В этом примере мы загрузим изображения в папку *images* в разделе **Служебные файлы**, :ref:`как описано выше <upload-images-for-import>`.

#. Откройте страницу **Администрирование → Импорт данных → Товары** [1] в панели администратора CS-Cart.

#. Убедитесь, что CSV-файл соответствует требованиям [2]. Вот пример::

     Product code;Language;Product name;Detailed image
     "D00014MK1P";"ru";"Мой новый товар";"images/test_image.jpg"

   Вы можете скопировать этот пример в пустой файл *.txt*, поменять его расширение на *.csv*, а затем открыть документ в любом редакторе таблиц, например, `LibreOffice Calc <https://www.libreoffice.org/discover/calc/>`_.

   * **Product code** — определяет, к какому товару относится изображение. Если вы введёте несуществующий код, то будет создан новый товар с указанным изображением.

     .. hint::

         Чтобы получить коды существующих товаров в формате CSV, откройте страницу **Администрирование → Экспорт данных → Товары** и экспортируйте ваши товары.

   * **Language** — код языка из двух букв, например, ``ru``. Это необходимое поле для импорта товаров.

   * **Detailed image** — название файла с изображением (а иногда и путь к нему). В этом примере мы укажем относительный путь к файлу из раздела **Служебные файлы**.

#. Укажите параметры импорта [3]. Не все из них обязательные, так как мы не импортируем категории, цены и пр. Вот параметры, которые нас интересуют:

   * **Директория с изображениями** — так как в CSV-файле мы указали путь к изображениям, эта настройка будет проигнорирована.

   * **CSV-разделитель** — выберите, как стоблцы таблицы отделяются друг от друга в CSV-файле. В примере выше разделителем была *точка с запятой* (``;``).

#. Выберите CSV-файл, который вы хотите импортировать [4]:

   * **Загрузить** — загрузить файл с вашего компьютера;

   * **Сервер** — выбрать один из файлов на сервере, где установлен CS-Cart;

   * **URL** — ввести прямую ссылку на файл.

#. Нажмите **Импорт** [5]. 

   Вы увидите полосу с индикатором прогресса. Когда полоса заполнится, изображения товаров обновятся. Если какого-то из кодов не было в базе данных, то для него будет создан товар.

   .. fancybox:: img/import_products_with_images.png
       :alt: Импорт товаров вместе с главными изображениями в CS-Cart.

-------------------------------------------------------------------------------
Пример 2: Импорт основных и дополнительных изображений для существующих товаров
-------------------------------------------------------------------------------

#. Подготовьте изображения товаров и загрузите их куда нужно.

   В этом примере мы загрузим изображения в папку *images* в разделе **Служебные файлы**, :ref:`как описано выше <upload-images-for-import>`.

#. Откройте страницу **Администрирование → Импорт данных → Товары** [1] в панели администратора CS-Cart.

#. Переключитесь на вкладку **Изображения** [2]. Убедитесь, что CSV-файл соответствует требованиям [3]. Вот пример::

     Product code;Pair type;Thumbnail;Detailed image
     "G0017";"M";"";"test_image.jpg"

   Вы можете скопировать этот пример в пустой файл *.txt*, поменять его расширение на *.csv*, а затем открыть документ в любом редакторе таблиц, например, `LibreOffice Calc <https://www.libreoffice.org/discover/calc/>`_.

   * **Product code** — определяет, к какому товару относится изображение. Если вы введёте несуществующий код, то эта строка в CSV-файле будет пропущена.

     .. hint::

         Чтобы получить коды существующих товаров в формате CSV, откройте страницу **Администрирование → Экспорт данных → Товары** и экспортируйте ваши товары.

   * **Pair type** — тип изображения:

     * *M* — главное изображение;

     * *A* — дополнительное изображение.

   * **Thumbnail** — уменьшенная версия изображения (иконка). Мы оставили поле пустым, чтобы иконка автоматически сгенерировалась на основе изображения.

   * **Detailed image** — название файла с изображением (а иногда и путь к нему). В этом примере мы укажем только название файла с расширением.

#. Укажите параметры импорта [4]:

   * **Директория с изображениями** — в этом примере мы не указали путь к изображению в CSV-файле, поэтому нам нужно будет задать пут к директории с изображениями относительно раздела **Служебные файлы**. В нашем случае мы введём в это поле следующее значение: ``images/``.

   * **Удалить дополнительные изображения** — поставьте галочку, чтобы удалить существующие дополнительные изображения у товара, прежде чем загружать новые.

   * **CSV-разделитель** — выберите, как стоблцы таблицы отделяются друг от друга в CSV-файле. В примере выше разделителем была *точка с запятой* (``;``).

#. Выберите CSV-файл, который вы хотите импортировать [5]:

   * **Загрузить** — загрузить файл с вашего компьютера;

   * **Сервер** — выбрать один из файлов на сервере, где установлен CS-Cart;

   * **URL** — ввести прямую ссылку на файл.

#. Нажмите **Импорт** [6].

   Вы увидите полосу с индикатором прогресса. Когда полоса заполнится, изображения товаров обновятся. Если какого-то из кодов не было в базе данных, то информация об изображениях для этого кода будет пропущена.

   .. fancybox:: img/import_product_images.png
       :alt: Импорт изображений для существующих товаров в CS-Cart.
