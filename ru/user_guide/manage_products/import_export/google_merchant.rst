**********************************************************
Как экспортировать данные товаров в Google Merchant Center
**********************************************************

CS-Cart позволяет экспортировать информацию о товарах в `Google Merchant Center <https://www.google.ru/retail/merchant-center/>`_. Для этого нужно экспортировать данные товаров файл, а затем `загрузить этот файл в Google <https://support.google.com/merchants/#topic=3404780>`_.

===========================
Шаг 1. Устанавливаем модули
===========================

1.1. Откройте страницу **Модули → Управление модулями** в панели администратора.

1.2. Перейдите на вкладку **Просмотреть все доступные модули**.

1.3. Убедитесь, что установлены модули **Конструктор прайс-листов** и **Прайс-лист для Google Base**; если нет, установите их.

* Модуль :doc:`"Конструктор прайс-листов" </user_guide/addons/data_feeds/index>` позволяет экспортировать данные в CSV-файлах, которые организованы так, как требуют сторонние сервисы.

* Модуль :doc:`"Прайс-лист для Google Base" </user_guide/addons/google_export/index>` позволяет использовать в прайс-листах поля, которые требует Google.

.. fancybox:: img/data_feeds_and_google_export.png
    :alt: Чтобы экспортировать товары в Google Merchant Center, у вас в магазине должны быть установлены модули "Конструктор прайс-листов" и "Прайс-лист для Goolge Base".

=========================
Шаг 2. Редактируем товары
=========================

.. important::

    На этом шаге нужно убедиться, что данные о товарах соответствуют `спецификации Google <https://support.google.com/merchants/answer/7052112>`_. Требования Google `были обновлены в 2016 году <https://support.google.com/merchants/answer/7000570>`_. Чтобы соответствовать этим требованиям, вам понадобится как минимум CS-Cart 4.4.1 или 4.5.1.

2.1. Задайте для товаров значения характеристик, которые использует Google. Для этого откройте страницу **Товары → Товары**, откройте товар, перейдите на вкладку **Характеристики**. Нужные характеристики находятся в группе **Google export features**; заполните те из них, которые уместны для товара.

Некоторые характеристики впервые появились только в CS-Cart 4.4.1:

* Age group

* Gender

* Size type

* Size system

.. note::

    Так же, как и другие характеристики, **Google export features** можно :doc:`экспортировать в CSV-файл </user_guide/manage_products/import_export/product_export>`. После редактирования вы сможете импортировать CSV-файл обратно и обновить таким образом значения характеристик сразу у многих товаров.

.. fancybox:: img/google_export_features.png
    :alt: Характеристики Google export features

2.2. Начиная с версии CS-Cart 4.4.1, можно экспортировать существующие опции товаров в Google в качестве ``color``, ``size``, ``pattern`` или ``material``.  Когда вы редактируете опцию (либо на странице **Товары → Опции**, либо на вкладке **Опции** у конкретного товара), вы можете выбрать для этой опции **Эквивалент в Google**. 

Например, если у вас в магазине есть опция **Цвет**, и вы выберете *Google color* в как её **Эквивалент в Google**, то при создании прайс-листа значение для **Google color** будет браться из опции **Цвет**.
      
.. fancybox:: img/equivalent_in_google.png
    :alt: Вы можете выбрать для своих опций эквиваленты в Google.

2.3. `У Google изменились требования к оформлению атрибута gtin. <https://support.google.com/merchants/answer/6352134>`_ Если в шаге 2.1 вы не введёте значение для характеристики GTIN, то CS-Cart 4.5.1 и более новые версии попытаются использовать **КОД** товара как GTIN.

:doc:`Комбинации опций </user_guide/manage_products/options/option_combinations>` можно экспортировать как отдельные записи в прайс-листе, начиная с CS-Cart 4.5.1. Возможность экспорта :doc:`вариаций товаров </user_guide/manage_products/products/product_variations>` таким же образом добавили в версии 4.7.2.

.. important::

    Чтобы комбинации опций и вариации товаров экспортировались правильно, для каждой опции, которая есть в комбинации/вариации, должен быть выбран **Эквивалент в Google** (см. шаг 2.2), и эти эквиваленты должны передаваться в прайс-листе, который вы создадите в шаге 3.

Если комбинация опций экспортируется как отдельная запись, то:

* Поле **КОД** от этой комбинации экспортируется в качестве GTIN.

* Изображение этой комбинации экспортируется в качестве главного изображения товара.

.. fancybox:: img/combination_gtin.png
    :alt: Перед тем, как экспортировать комбинации опций в Google, введите GTIN в поле CODE у комбинации.

===============================
Шаг 3. Создаём прайс-лист (фид)
===============================

3.1. Откройте страницу **Модули → Прайс-листы**.

3.2. :doc:`Создайте новый прайс-лист </user_guide/addons/data_feeds/create_df>` или отредактируйте существующий прайс-лист *Google base* в соответствии с вашими требованиями и `спецификациями Google <https://support.google.com/merchants/answer/7052112>`_. Обратите внимание на подсказку справа: там описан ряд требований. Вот ещё пара важных моментов:

* Когда вы создаёте прайс-лист для Google, обязательно выберите **Макет** *google_export*. Это позволит вам экспортировать опции товаров Google Merchant Center, как описано в шаге 2.2, но только если вы добавите эти опции на вкладке **Таблица соответствия полей**.

* На вкладке **Общее** на странице редактирования прайс-листа выделите оба типа (*Простой товар* и *Вариация товара*). Выделить несколько типов можно, удерживая клавишу Ctrl.

3.3. Чтобы создать файл фида, нажмите на кнопку с изображением шестерёнки и выберите **Загрузить**.

.. fancybox:: img/download_data_feed.png
    :alt: Нажмите на кнопку с изображением шестерёнки и выберите "Загрузить", чтобы скачать файл фида.

===========================================
Шаг 4. Отправляем прайс-лист (фид) в Google
===========================================

У Google есть инструкции, как `зарегистрировать <https://support.google.com/merchants/answer/188475>`_ и `загрузить <https://support.google.com/merchants/answer/188477>`_ фид данных о товарах. Мы рекомендуем сначала загрузить тестовый фид и убедиться, что не возникло никаких ошибок.
