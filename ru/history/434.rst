4.3.3 → 4.3.4
-------------

    [+] — Новое

    [*] — Изменение 

    [!] — Исправлена ошибка



[+] Модули: "Ограничение по возрасту": Новое условие для промо-акций "День рождения покупателя". Добавлено новое поле для экспорта/импорта дней рождения в разделе "Покупатели".   

[+] Модули: "Обратный звонок": Добавлен CSS класс на кнопку "Купить в один клик". 

[+] Модули: "Зависимости для способов оплаты": Новый модуль. Добавляет настройку "Разрешенные способы оплаты" на странице редактирования способа доставки. Позволяет устанавливать зависимость между способами оплаты и способами доставки.

[+] Цифровые товары: Добавлено отображение лицензионного соглашения на странице загрузки файлов.

[+] Языки: Добавлена поддержка RTL

[+] Хуки: Добавлены хуки в функциях fn.locations.php

[+] Хуки: Добавлены POST и SQL хуки в в функции fn_get_banner_data

[+] Хуки: Добавлены PRE, POST, SQL хуки в в функции fn_get_tags

[+] Маркетинг: Брошенные корзины: Добавлена колонка "Номер заказа". Необходимо для онлайн платежей, чтобы не терять покупателей, которые ушли на оплату и не вернулись. Когда покупатель ушел на оплату, ему создаётся "Незавершенный" заказ, номер заказа будет добавлен к брошенной корзине. При успешной оплате, заказ переходит в позитивный статус (обработан, открыт или согласно настроек способа оплаты).

[*] Модули: 1C: Модуль переименован в "CommerceML – синхронизация интернет-магазина с 1С, МойСклад, Класс365". Обмен данными с сайтом в формате CommerceML. Импорт товаров в интернет-магазин и экспорт заказов из интернет-магазина.

[*] Модули: 1C: Переименована настройка "Общая категория для товаров из 1С" в "Общая категория для загружаемых товаров"

[*] Модули: 1C: Переименована настройка "Импортировать только количество и цены (файл offers)" в "Импортировать количество и цены (файл offers)"

[*] Модули: 1C: Добавлены различные точки входа (URL) для обмена данными с разными сервисами: ``домен/exim_1c``, ``домен/exim_cml``, ``домен/exim_moysklad``, ``домен/exim_class``.

[*] Модули: 1C: Добавлена настройка модуля "Выгружать опции товара" для выгрузки опций товаров в заказе.

[*] Модули: 1C: Добавлена выгрузка дополнительных полей профиля в заказе (ИНН, КПП).

[*] Модули: 1C: Добавлена выгрузка скидок заказа (промо-акции и скидка на заказ).

[*] Модули: 1C: Добавлена выгрузка способа доставки в заказе.

[*] Модули: 1C: Добавлена настройка товара "Обновлять товар" на странице редактирования товара. Можно отключить обновление товара.

[*] Модули: 1C: Добавлена настройка модуля "Значение для связывания товаров", можно настроить параметры связи товаров, варианты настройки: "По умолчанию", "Артикул", "Штрихкод".

[*] Модули: 1C: Добавлена настройка модуля "Значение для связывания категорий" для связывания категорий, варианты настройки: "По умолчанию", "Название".

[*] Модули: 1C: Добавлена настройка модуля "Загружать товары", варианты настройки: "Все товары", "Новые товары", "Только обновить товары", "Не загружать"

[*] Модули: 1C: Добавлена настройка загрузки значения из тега "Изготовитель".

[*] Модули: 1C: Изменена настройка "Импортировать только количество и цены (файл offers)", при выключении настройки цена и количество загружаться не будут.

[*] Модули: 1C: Учёт типа свойства товара при создании характеристики (число, строка, справочник (как строка)).

[*] Модули: 1C: Добавлена настройка "Загружать статусы заказов" для обновления статусов заказа в магазине.

[*] Модули: 1C: Добавлена выгрузка налога в заказе.

[*] Модули: Служба доставки — СДЭК: Изменена передача артикула в качестве кода товара в СДЭК.

[*] Модули: Служба доставки — СДЭК: Добавлено поле для указания наложенного платежа передаваемого заказа.

[*] Модули: Служба доставки — СДЭК: Передача скидок заказа в СДЭК.

[*] Модули: Служба доставки — СДЭК: Обновлен список городов.

[*] Модули: Служба доставки — СДЭК: Передача данных в СДЭК для вызова курьера.

[*] Модули: Служба доставки — СДЭК: Передача данных в СДЭК для прозвона покупателя.

[*] Модули: Города: Обновлен список городов.

[*] Модули: eDost: Обновлен список городов.

[+] Центр обновелений: Добавлена возможность просматривать информацию об установленных обновлениях. 

[*] Модули: Google analytics: Код счётчика перенесён в секцию <head>.

[*] Ядро: Проверка лицензий: Отключены запросы проверки лицензий в панели администратора.

[*] Ядро: Параметр конфигурации "saas_uid" переименован в "store_prefix". Параметр используется при хранении кэша в Redis. Обратная совместимость сохранена на текущей версии.

[*] Дизайн: Макеты: Добавлена возможность задать сортировку в блоке "Категории", если содержимое блока выбрано в ручную.

[*] Дизайн: Макеты: Динамическое дерево удалено из настроек содержимого в блоке "Категории".

[*] Email: Изменён алгоритм валидации email адресов, он стал менее строгим.

[*] JavaScript: Добавлена поддержка JSMin PHP.

[*] Пользователи: Администраторы: Удалена возможность изменить email и пароль администратора в личном кабинете на витрине, теперь только из панели администратора.

[*] Центр обновлений: Уведомление администратора о истечении подписки на обновления.

[*] Центр обновлений: Подтверждение начала восстановления после неудачного обновления. Раньше восстановление начиналось сразу после клика по ссылке в письме.

[!] Модули: Unisender: Пользователь не добавлялся в Unisender при подпискe через блок "Подписаться".

[!] Модули: Самовывоз: Не работал выбор пунктов самовывоза при редактировании заказа в панели администратора.

[!] Модули: Яндекс.Метрика: Internal Server error при неправильном введенных настройках авторизации.

[!] Модули: eDost: Добавлен таймаут запросов к eDost серверу.

[!] Модули: eDost: Поправлен "PHP Warning: Cannot modify header information" при отслеживании доставки.

[!] Модули: Русские способы оплаты: При оплате с детальной страницы заказа неправильно использовался номер заказа.

[!] Модули: Хиты продаж: Исправлена ошибка неправильной выборки похожих товаров в блок "Похожие товары".

[!] Модули: Подарочные сертификаты: Исправлена ошибка использования подарочного сертификата, если выбрана не основная валюта.

[!] Модули: Поддержка HiDPI: На Retina дисплеях не загружались изображения в слайдерах.

[!] Модули: Платежи через PayPal: Исправлен PHP notice, если покупатель не выбрал страну при оплате через PayPal.

[!] Модули: Прайс-лист: Исправлен PHP notice при установке модуля.

[!] Модули: RSS-лента: Исправлена дата в поле "lastBuildDate".

[!] Модули: SEO: Исправлены ошибки форматов URL в настройках модуля.

[!] Модули: Поиск ближайших магазинов: Исправлены ошибка с привилегиями модуля. Добавлены новые привилегии "Просмотр расположений магазинов" и "Управление расположением магазинов". 

[!] Модули: Водяные знаки: Исправлена опечатка в настройках модуля.

[!] API: Products: Features: Характеристика товара не присваивалась товару, если у характеристики были выбраны категории.

[!] Cache: Blocks: Неправильно работала автоочистка кэша при использовании APC и XCache.

[!] Cache: Blocks: Исправлено кэширование блока "Недавно просмотренные".

[!] Оформение заказа: Исправлена 403 ошибка при нажатии кнопки "Оформить заказ". Ошибка воспроизводилась при особых условиях и комбинациях настроек страницы оформления заказа.

[!] Оформение заказа: Адреса оплаты и доставки неправильно сохранялись, если были отключены шаги "Выбор способа оплаты" и "Выбор способа доставки".

[!] Оформение заказа: Email некоректно сохранялся, если были отключены шаги "Выбор способа оплаты" и "Выбор способа доставки".

[!] Оформение заказа: Кнопка "Оформить заказ" не заменялась на "Пересчитать стоимость доставки", если была выбрана настройка "Адрес доставки совпадает с адресом оплаты".

[!] Оформение заказа: PHP notice "Undefined index: country..." при создании заказа, если было отключено поле "Страна".

[!] Ядро: JavaScript: Исправлена JS ошибка при использовании нескольких списков (selectboxes) выбора одновременно.

[!] Дизайн: Email: Тег <br> отображался в письмах, если было использовано несколько адресов электронной почты.

[!] Дизайн: Меню: Исправлена подсветка в меню после смены валюты.

[!] Дизайн: Стили были улучшены. Точка :)

[!] Email: Исправлена ошибка SMTP при смене статуса заказа.

[!] Экспорт/импорт: Товары: Не сохранялись миниатюры при импорте.

[!] Изображения: Ошибка в обратной совместимости функции fn_resize_image()

[!] Изображения: Миниатюры не генерировались, если использовалась конфигурация lazy loading и навание изображения содержало особые символы.

[!] Макеты: Блоки: Категории: Выравнивание основного содержимого по правому краю исправлено.

[!] Меню: Вертикальное меню не работало на мобильных устройствах.

[!] Опции: Разрешённые комбинации: Опции работли некоректно, если у комбинации было несколько опций без выбранных вариантов.

[!] Опции: Разрешённые комбинации: Неправильно работали выбранные по умолчанию опции.

[!] Owl carousel: Не загружались изображения, если покупатель нажимал влево. 

[!] Способы оплаты: HSBC: Удалена поддержка Windows.

[!] Способы оплаты: Innovative: PHP notice при транзакции.

[!] Способы оплаты: PayPal Express: Кнопка "PayPal" отображалась для незарегистрированных покупателей, даже если была запрещена покупка для незарегистрированных покупателей в панели администратора.

[!] Способы оплаты: В некоторых ситуациях, если покупатель отменял оплату, его возвращало на пустую корзину.

[!] Товары: Цифровые товары: Небыло возможности удалить файл предпросмотра.

[!] Товары: Характеристики: Большое количество вариантов характеристик вызывало проблемы производительности.

[!] Товары: Характеристики: Параметры поиска по категории не сохранялись при редактировании характеристики.

[!] Товары: Характеристики: Не отображались группы без характеристик.

[!] Товары: Характеристики: Некоректно работала пагинация.

[!] Товары: Характеристики: Отображалась страница 404, если у характеристики небыло вариантов.

[!] Товары: Характеристики: Не закрывалость всплывающее окно редактирования характеристик в Internet Explorer 9.

[!] Товары: Характеристики: Ошибка при подсчёте количества вариантов характеристик в функции "fn_get_product_features", считались варианты выбранные у товаров.

[!] Товары: Фильтры: Скрывались все фильтры, когда для комбинации фильтров не было товаров. 

[!] Товары: Быстрый просмотр: Исправлено переключение товаров.

[!] Товары: Быстрый поиск товаров не работал в панели администратора.

[!] Товары: Сортировка: Исправлена сортировка "новинки", дата создания товара с точностью до секунд. 

[!] Вкладки товара: При добавлении новой вкладки, не работала проверка на обязательное поле "Блок", создавалась вкладка без блока.

[!] Промо-акции: Группы условий "любой" работали некоректно.

[!] Способы доставки: Исправлено отображение вкладки "Настройки" на способах доставки с ручным расчётом стоимости доставки.

[!] Способы доставки: USPS: USPS Priority Mail International не работал в Канаду.

[!] Smarty: Констаны "DEFAULT_FILE_PERMISSIONS" and "DEFAULT_DIR_PERMISSIONS" не использовались при генерации кэша.

[!] Шаблоны: Исправлена ошибка при генерации кэша перезаписанных (overrides) шаблонов. 

[!] Центр обновлений: Уведломние о доступности обновлений не удалялось после обновления.

[!] Группы пользователей: Привилегии: Нельзя было ограничить доступ к функциональности редактирования шаблонов (Дизайн → Шаблоны)

[!] Пользователи: Регистрация: Тема Basic: Поле E-mail было скрыто при регистрации, если была выключена быстрая регисрация в теме Basic.

[!] {#5757} Товары: Опции: Файлы: Сбрасывался выбранный файл в некоторых ситуациях.

[!] {#5776} PayPal: Проблема с диакритическими символами.

[!] {#5784} Хуки: обратная совместимость в хуке "pre_validate_promotion_attribute".

[!] {#5803} Дизайн: Basic: Фильтры: Суфикс характеристик отображался дважды.

[!] {#5822} Модули: Обязательные товары: Товары добавлялись дважды при редактировании заказа.

[!] {#5831} Модули: Социальные кнопки: Не работал скролл на мобильных устройствах при открытом диалоговом окне.

[!] {#5839} Модули: SEO: PHP notices, переменная "SCRIPT_FILENAME" не работает при запуске через CRON.

[!] {#5842} Промо-акции: Условие "Товары в списке" работало некорректно.

[!] {#5861} Кэш: APC: XCache: Конфликт кэша при двух и более инсталяциях на одном сервере.

[!] {#5869} Экспорт/импорт: Изображения с URL содержащим нелатинские символы и другие спец. символы не импортировались.

[!] {#5870} Экспорт/импорт: Заказы: SQL ошибка, если данные имели пустую колонку ip_address 

[!] {#5895} Товары: Не увеличивается популярность товара при посещении страницы с товаром.

[!] {#5930} JavaScript: Internet Explorer 8: Ошибка "Tygh undefined" в Internet Explorer 8

[!] {#5933} Модули: Опросы: Исправлена ошибка с обязательными вопросами в опросах.

[!] {#5953} Хуки: Дубликат update_option_combination

[!] {#5954} Модули: "Ограничение по возрасту": Покупатели не могли видеть товары, даже если ввели подходящюю дату рождения.