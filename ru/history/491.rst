*****
4.9.1
*****

==================================
Новая функциональность и улучшения
==================================

[+] Администрирование: Резервное копирование и восстановление: Добавлена кнопка для копирования CRON-команды.

[+] Интерфейс: Модули: В разные места интерфейса (например, на страницу редактирования способа оплаты) были добавлены уведомления о том, что модули могут предоставить дополнительную функциональность (например, другие процессоры для способов оплаты).

[+] Модули: Вход в панель администратора через Google: Добавлен модуль для входа в панель администратора магазина через учётную запись в Google.

[+] Модули: Отзывы и комментарии: Добавлена возможность разрешить оставлять отзывы на товар только тем, кто этот товар покупал.

[+] Модули: Отзывы и комментарии: Добавлены настройки, которые позволяют по умолчанию включить или отключить отзывы для создаваемых товаров, категорий и страниц.

[+] Модули: Простое оформление заказа [Beta]: Добавлен новый модуль, который делает страницу офорлмения заказа короче, меняет порядок действий (сначала город и способ доставки, а потом все остальные данные) и убирает разбиение на шаги.

[+] Способы оплаты: Добавлен новый шаблон "empty.tpl".

[+] Товары: В панели администратора добавлена возможность выделять несколько товаров на списке товаров с помощью клавиши Shift.

[+] Товары: Добавлен новый механизм быстрого редактирования выделенных товаров.

[+] Хлебные крошки: Для товаров, которые есть на нескольких витринах, добавлена возможность задавать категорию которая будет отображаться в "хлебных крошках".

[+] Хуки: Блок-менеджер: Локации: Добавлен хук "block_manager:update_location_general".

[+] Ядро: БД: Добавлен индекс для product_feature_variant_descriptions.variant.

[+] Ядро: Реализован механизм блокировок при генерации кеша блоков и компиляции стилей, необходимый для решения проблем с состоянием гонок и нагрузок на сервер при массовом отсутствии кеша.

[+] Multi-Vendor Plus: Модули: Добавлен новый модуль "Общие товары для продавцов [Beta]". Он позволяет владельцу магазина создать единую товарную базу, а продавцам выбрать, какие из этих товаров они продают, и на каких условиях.

[+] Multi-Vendor Plus: Модули: Добавлен новый модуль "Оплата напрямую продавцам [Beta]". Он позволяет продавцам создавать свои собственные способы оплаты, чтобы деньги шли напрямую им, а владельцу магазина не приходилось их распределять.

[+] Multi-Vendor Plus: Модули: Добавлен новый модуль "Привилегии для продавцов". Он позволяет настраивать группы пользователей для администраторов продавцов.

[+] Multi-Vendor Plus: Модули: Добавлен новый модуль "Тарифные планы для продавцов: Комиссии для категорий". Он позволяет владельцам магазина устанавливать разные комиссии за продажу товаров из разных категорий в зависимости от тарифного плана продавца.

[+] Multi-Vendor: Добавлена возможность настраивать поля на форме регистрации продавца.

[+] Multi-Vendor: Модули: Тарифные планы для продавцов: Добавлена возможность назначать фиксированную комиссию за заказ.

=========================================
Изменения в существующей функциональности
=========================================

[*] Адаптивная панель администратора: Меню: Микроформат "cm-sticky-scroll" заменён на "position: sticky;" (кроме Internet Explorer 11).

[*] Модули: АТОЛ Онлайн: Добавлен тестовый режим.

[*] Модули: Вход через соцсети: Провайдеры OpenID и AOL отключены. Если они были созданы до обновления, они останутся, но создать их будет нельзя.

[*] Модули: Определение местоположения: Дизайн выбора города был обновлен.

[*] Модули: Отзывы и комментарии: Теперь при дублировании товара в дубль не копируются отзывы и комментарии.

[*] Модули: Платежи через PayPal: Добавлена валюта "Индийская рупия".

[*] Модули: Старая панель администратора: Модуль объявлен устаревшим; он не будет обновляться и получать исправления ошибок, а в дальнейшем будет удалён.

[*] Модули: Теперь у модулей, которые идут в комплекте с CS-Cart или Multi-Vendor как разработчик указан CS-CART.

[*] Способы оплаты: Некоторые устаревшие и неиспользуемые шаблоны (fax.tpl, check.tpl, business_check.tpl) были удалены.

[*] Ядро: Минимальная требуемая версия PHP поднята с 5.3.6 до 5.6.0.

[*] Multi-Vendor: Модули: Чат с продавцом: Добавлена возможность настроить привилегии для групп пользователей.

[*] Multi-Vendor: Настройки: Теперь возможность разрешить продавцам редактировать стили и темы доступна только в Multi-Vendor Plus.

[*] Multi-Vendor: Поля профиля: Теперь условия, на которые должны согласиться продавцы при регистрации, являются полем профиля, которое вы можете отредактировать или отключить.

[*] Multi-Vendor: Поля профиля: Убрано поле "Факс" (если у вас оно раньше использовалось, то в базе данных значения останутся).

[*] Multi-Vendor: Товары: Популярность: Теперь продавцы не могут менять значение поля “Popularity” у товара.

==================
Исправления ошибок
==================

[!] Multi-Vendor: Модули: Местоположение продавцов [Beta]: Блок "Поиск по местоположению" можно было добавить на любую страницу (даже если она не подходила для этого блока). Исправлено.

[!] Multi-Vendor: Модули: Чат с продавцом: В адаптивной панели администратора кнопка отправки сообщения выходила за пределы экрана на мобильных устройствах. Исправлено.

[!] Дизайн: Макеты: После открытия всплывающего окна с настройками блока страница прокручивалась к началу. Исправлено.

[!] Дизайн: Некорректно отображалась дата в блоке “Копирайт”. Исправлено.

[!] Дизайн: Шаблоны: Одна из полос прокрутки находилась рядом не с той областью. Исправлено.

[!] Заказы: Подписчики на товар получали уведомления о появлении товара в наличии при редактировании товаров с отсутствующими в наличии товарами. Исправлено.

[!] Магазины: Если URL двух витрин были практически одинаковыми (например example.com и example.com.ua), то мог произойти редирект на неверную витрину. Исправлено.

[!] Модули: CommerceML: Обмен данными по схеме 2.07 и со способом загрузки опций "Комбинация из одной опции (цена задана в модификаторах)" не обновлял модификатор опций, если товар был общим для нескольких витрин. Исправлено.

[!] Модули: CommerceML: При импорте товара менялась его основная категория. Исправлено.

[!] Модули: CommerceML: При импорте товара не отправлялось уведомление покупателям о том, что товар появился в наличии. Исправлено.

[!] Модули: SEO: В ссылках некоторые символы литовского и латышского алфавитов не конвертировались в соответствующие английские символы. Исправлено.

[!] Модули: SEO: Галочка "Перенаправлять со старого URL" не появлялась после изменения SEO-имени. Исправлено.

[!] Модули: SEO: Канонические мета-ссылки не генерировались для некоторых страниц. Исправлено.

[!] Модули: АТОЛ Онлайн: В чеке не конвертировалась валюта. Исправлено.

[!] Модули: Вариации товаров [Beta]: Если у вариации была задана оптовая скидка за покупку 1 товара, то при редактировании родительского товара эта вариация исчезала со списка вариаций родительского товара. Исправлено.

[!] Модули: Вариации товаров [Beta]: Появлялись PHP нотисы при сохранении изменений на вкладке Вариаций. Исправлено.

[!] Модули: Вариации товаров [Beta]: Характеристики настраиваемых товаров могли перепутаться при сравнении. Исправлено.

[!] Модули: Вход через соцсети: Провайдер Live не работал. Исправлено.

[!] Модули: Комбинации товаров: При нажатии на кнопку выбора опций страница товара прокручивалась вверх на мобильных устройствах. Исправлено.

[!] Модули: КупиВКредит: В живом режиме происходило перенаправление на тестовый URL. Исправлено.

[!] Модули: Местоположение покупателя: При попытке сохранить пустой список городов для геолокации возникала ошибка PHP Notice. Исправлено.

[!] Модули: Мобильное приложение: SEO: При выключенном модуле SEO генерировался неверный адрес для API. Исправлено.

[!] Модули: Платежи через PayPal: PayPal Standard: При перенаправлении покупателя на страницу PayPal не учитывался язык, который покупатель выбрал в магазине. Исправлено.

[!] Модули: Поддержка HiDPI: Для модуля "Увеличенные изображения товаров" на дисплеях с высоким разрешением (Retina) подгружалась обычная, а не большая картинка. Исправлено.

[!] Модули: Прайс-лист для Google Base: Если товара не было в наличии, то в выгрузке не рассчитывалась цена этого товара. Исправлено.

[!] Модули: Расширенный импорт товаров: CSV-файлы с окончаниями строк в формате macOS не могли быть импортированы. Исправлено.

[!] Модули: Расширенный импорт товаров: Привилегии: Пользователь без привилегии "Управление каталогом" всё равно мог найти способ импортировать товары. Исправлено.

[!] Модули: Расширенный импорт товаров: Пустые поля в заголовке CSV-файла вызывали ошибки при сохранении пресета импорта. Исправлено.

[!] Модули: Российские способы оплаты: Сбербанк: QR-код был указан в HTTP (без защиты). Исправлено.

[!] Модули: Самовывоз: Карта не загружалась, если был выбран язык, который не поддерживается Яндекс.Картами. Исправлено.

[!] Модули: Экспорт в Яндекс.Маркет: При экспорте комбинаций опций товара не экспортировались их категории. Исправлено.

[!] Обновление: Процесс обновления мог оборваться при создании резервных копий больших таблиц. Исправлено.

[!] Оформление заказа: Доставка: Для пользователя, не вошедшего в учётную запись, город и область не заполнялись из настроек магазина. Исправлено.

[!] Панель администратора: Сохранённый поиск: Если после использования сохранённого поиска администратор вбивал другой запрос в поисковую строку, то не было очевидно, что параметры сохранённого поиска ещё применяются. Исправлено.

[!] Пользователи: Функциональность "действовать от лица пользователя" не работала на PHP 7.2. Исправлено.

[!] Пункты назначения: Страны в списке на странице настройки пунктов назначения отображались только с названиями на базовом языке. Исправлено.

[!] Статусы заказов: Не работал выбор цветов для статусов заказов. Исправлено.

[!] Страницы: Ссылки: Не работала галка "Открывать в новом окне" в настройках ссылки. Исправлено.

[!] Товары:  Характеристики: На детальной странице товара отображались характеристики из отключенных групп. Исправлено.

[!] Товары: Изображения: Порядок изображений был неверным, если их позиция была явно не определена после обновления до 4.8.1. Исправлено.

[!] Товары: Изображения: После клонирования товара терялся порядок изображений. Исправлено.

[!] Товары: Категории: Select2: Выпадающий список с категориями на странице редактирования товара мог отображаться неправильно в некоторых случаях. Исправлено.

[!] Товары: Меню смены статусов товара не открывалось на мобильных устройствах. Исправлено.

[!] Центр обновлений: Пропуск резервного копирования: При пропуске резервного копирования отправлялось письмо о резервной копии. Исправлено.

[!] Электронная почта: Уведомления о заказе: Настройки статуса не были доступны в старых шаблонах email-уведомлений. Исправлено.

[!] Ядро: База данных: Сессия могла испортиться после сохранения в базу данных символа не из Unicode. Исправлено.

[!] {#5388} Модули: Деловые Линии: У города Иваново был неверный идентификатор. Исправлено.

[!] {#5426} Модули: Российские способы оплаты: Сбербанк: QR-код не распознавался в приложении банка. Исправлено.

[!] {#7325} Товары: Редактировать выбранные: Не отображались изображения товаров. Исправлено.

[!] {#7328} Multi-Vendor: Модули: Выплата долгов продавцов: Продавец не мог оплатить долг при включенном модуле "Режим каталога". Исправлено.

[!] {#7349} Модули: Платежи через PayPal: Настройки модуля нельзя было отредактировать, если в магазине было несколько витрин. Исправлено.

[!] {#7388} Модули: Расширенный импорт товаров: Файлы шаблонов не загружались по ссылке, если у файла в URL было неподдерживаемое расширение. Исправлено.
