*****
4.8.2
*****

==================================
Новая функциональность и улучшения
==================================

[+] Адаптивная панель администратора: Мобильное меню: Добавлена возможность выбрать витрину или продавца при работе с панелью администратора на мобильных устройствах.

[+] Дизайн: Панель администратора: Для некоторых объектов (характеристик, групп характеристик, страниц и постов блога) было добавлено отображение ID.

[+] Модули: eDOST: Добавлены новые службы доставки.

[+] Модули: Местоположение покупателя: Добавлен новый модуль для определения местоположения покупателя и автоматического заполнения адреса при оформлении заказа.

[+] Модули: Магазин на Facebook: Теперь возможность добавить магазин во вкладку на Facebook реализована через отдельный модуль: https://github.com/cscart/addon-facebook-store.

[+] Резервное копирование: Добавлена возможность создания резервных копий магазина в командной строке.

[+] Товары: Категории: На странице редактирования товара категорию теперь можно выбрать не только вводом части названия, но и из дерева категорий.

[+] Хуки: Добавлены новые хуки в design/backend/templates/pickers/categories/js.tpl и design/backend/templates/pickers/categories/picker.tpl.

[+] Ядро: Добавлена проверка, включено ли zlib-сжатие в конфигурации PHP.

=========================================
Изменения в существующей функциональности
=========================================

[*] Адаптивная панель администратора: Обновлены стили кнопок, текстовых полей и языков с письмом справа налево.

[*] Модули: "Купи в Кредит": Способ оплаты был обновлён.

[*] Модули: Водяные знаки: Улучшена выборка данных при генерации изображений.

[*] Модули: Платежи через PayPal: Теперь в PayPal Standard налог передаётся не как отдельный товар.

[*] Модули: Теперь после действий над модулями на списке модулей не сбрасываются фильтры и не происходит перенаправление на вкладку по умолчанию.

[*] Модули: Теперь у всех модулей, которые поставляются с CS-Cart, название компании-производителя на списке модулей является ссылкой и ведёт в Help Desk.

[*] Панель администратора: Улучшено всплывающее окно с информацией о CS-Cart Ultimate и дополнительных витринах.

[*] Способы оплаты: PayAnyWay: Интеграция была обновлена с учётом изменений на стороне PayAnyWay для отправки информации об оплаченном заказе в ОФД.

[*] Способы оплаты: ServiRed: Добавлена поддержка PHP 7.1 и более новых версий.

==================
Исправления ошибок
==================

[!] Адаптивная панель администратора: В списке товаров у разных товаров были разные размеры иконок. Исправлено.

[!] Адаптивная панель администратора: Группы пользователей: При присоединении пользователя к группе пользователей возникала ошибка PHP Notice. Исправлено.

[!] Адаптивная панель администратора: Заказы: Выпадающий список смены статусов на списке заказов на мобильных устройствах обрезался. Исправлено.

[!] Адаптивная панель администратора: Заказы: В расширенном поиске в поле кода подарочного сертификата выпадающий список имел некорректную ширину. Исправлено.

[!] Адаптивная панель администратора: Категории: Кнопка "Плюс" на странице редактирования категории была слишком узкой. Исправлено.

[!] Адаптивная панель администратора: Меню: Если модуль добавлял какой-то новый пункт меню, то этот пункт меню не добавлялся после установки модуля, если не обновить страницу в браузере. Исправлено.

[!] Адаптивная панель администратора: Модули: Города, СДЭК, eDOST: Коды городов отображались как редактируемые, хотя возможности редактирования не должно быть. Исправлено.

[!] Адаптивная панель администратора: На странице списка товаров нельзя было выделить и скопировать коды товаров (артикулы). Исправлено.

[!] Адаптивная панель администратора: Ограничения доступа: Кнопка “Сохранить” не имела отступов. Исправлено.

[!] Адаптивная панель администратора: Прозрачные изображения обрезались в предпросмотре загрузчика изображений. Исправлено.

[!] Адаптивная панель администратора: Смена статусов заказа вылезала за границы экрана на телефонах. Исправлено.

[!] Адаптивная панель администратора: Статусы заказа: Выпадающее меню обрезалось. Исправлено.

[!] Адаптивная панель администратора: Строка с заголовком страницы перекрывала боковую панель. Исправлено.

[!] Адаптивная панель администратора: Товары: Редактировать выбранные: На странице массового редактирования товара неправильно отображались категории. Исправлено.

[!] Витрины: Категории: При удалении витрины не удалялись связи категорий этой витрины с товарами других витрин. Исправлено.

[!] Дизайн: Содержимое корзины: Если была включена настройка "Покупатель должен зарегистрироваться либо войти, чтобы оформить заказ", то блок для входа в учётную запись появлялся на странице корзины даже тогда, когда на этой странице было невозможно оплатить заказ. Исправлено.

[!] Дизайн: Товары: Промо-текст: Длинный промо-текст выходил за границы своей области. Исправлено.

[!] Дизайн: Языки с письмом справа налево: При выборе языка с письмом справа налево длинные "хлебные крошки" отображались неправильно. Исправлено.

[!] Модули: АТОЛ Онлайн: Журнал АТОЛ Онлайн отображался некорректно при длинном URL или Запросе/Ответе. Исправлено.

[!] Модули: Блог: Блок "Прокрутка последних постов" не отображался на странице блога, если в качестве родительской страницы была выбрана одна из веток постов. Исправлено.

[!] Модули: Вариации товаров [Beta]: "Количество штук в коробке" и "Размер коробки" у вариаций не экспортировались. Исправлено.

[!] Модули: Вариации товаров [Beta]: Импорт: Если удалить опции и вариации товара, то вариации не привязывались к товару даже после того, как его импортировали со всеми опциями и вариациями. Исправлено.

[!] Модули: Вариации товаров [Beta]: Отключение опции товара, которая участвует при создании вариаций, приводит к ошибке на странице товара на витрине. Исправлено.

[!] Модули: Вариации товаров [Beta]: При клонировании несколько товаров в логах была ошибка PHP Notice. Исправлено.

[!] Модули: Вариации товаров [Beta]: При попытке создать вариацию для товара, у опций которого не было ни одного варианта, возникала ошибка PHP Notice. Исправлено.

[!] Модули: Вариации товаров [Beta]: Привилегии: Администратор с привилегией "Просмотр каталога" не мог видеть список вариаций на вкладке "Вариации" у родительского товара. Исправлено.

[!] Модули: Возврат товаров: Неверно пересчитывались налоги при пересчете стоимости заказа при оформлении возврата. Исправлено.

[!] Модули: Города: Город Севастополь находился не в том регионе. Исправлено.

[!] Модули: Деловые Линии: Стоимость доставки рассчитывалась некорректно, если были включены дополнительные параметры. Исправлено.

[!] Модули: Деловые линии: Для города Муром был задан неверный идентификатор. Исправлено.

[!] Модули: Местоположение покупателя: Заданный на форме расчета доставки город сбрасывался на автоматически определенный при перерасчете корзины. Исправлено.

[!] Модули: Платежи через PayPal: Статус способа оплаты в информации о заказе всегда был "Тест". Исправлено.

[!] Модули: Подарочные сертификаты: Разделителем тысяч в сумме подарочного сертификата всегда была запятая, независимо от разделителя у валюты. Исправлено.

[!] Модули: Поставщики: Получение данных о поставщиках на домашней странице панели администратора значительно замедляло время загрузки страницы. Исправлено.

[!] Модули: Поставщики: При редактировании заказа с поставщиками, администратор мог выбрать способы доставки, которые не были доступны для поставщика. Исправлено.

[!] Модули: Рассылки: На последнем шаге оформления заказа возникал PHP Notice, если на странице присутствовал скрытый список рассылок. Исправлено.

[!] Модули: Расширенный импорт товаров [Beta]: В некоторых случаях при неправильном формате CSV-файла возникала ошибка PHP Notice. Исправлено.

[!] Модули: Расширенный импорт товаров [Beta]: Когда в XML-файле свойства товара задавались  в атрибутах XML-элементов, то в пресете могло создаваться много лишних элементов для сопоставления. Исправлено.

[!] Модули: Расширенный импорт товаров [Beta]: При импорте файла по ссылке, URL файла на странице редактирования пресета был неверным. Исправлено.

[!] Модули: Расширенный импорт товаров [Beta]: Редактор файлов на странице настроек пресета работал некорректно. Исправлено.

[!] Модули: Расширенный импорт товаров [Beta]: У некорректного CSV-файла мог упасть процесс импорта. Исправлено.

[!] Модули: Российские способы оплаты: Если рубль не был основной валютой, то в QR-коде сумма заказа передавалась в основной валюте, а не в рублях. Исправлено.

[!] Модули: Соответствие GDPR: Вместо данных пользователя в XML-выгрузку могли попасть данные компании из заказа. Исправлено.

[!] Модули: Экспорт в Яндекс.Маркет: Неправильно обрабатывался код валюты для белорусского рубля (BYN). Исправлено.

[!] Модули: CommerceML: При выгрузке заказов в 1С были ошибки, если заказ был не в основной валюте магазина, а название этой валюты отличалось в 1С и в CS-Cart. Исправлено.

[!] Модули: eDOST: Для города Курск был задан неверный идентификатор eDOST. Исправлено.

[!] Модули: SEO: Если при обращении к домашней странице были параметры в URL, то мог произойти редирект на тот же URL, но с кодированными специальными символами. Исправлено.

[!] Налоги: После изменения значения настройки "Расчет налога по" с "Цена за единицу" на "Подытог" налоги могли рассчитываться неверно, если у покупателя до изменения настройки были товары в корзине. Исправлено.

[!] Панель администратора: Заказы: Налоги: Название налога не менялось при смене языка. Исправлено.

[!] Панель администратора: Экспорт/Импорт: Ссылка на экспорт товаров в боковой панели вела на новый импорт товаров. Исправлено.

[!] Способы доставки: USPS: При расчёте доставки в Черногорию возникала ошибка. Исправлено.

[!] Способы доставки: Не работало удаление на странице редактирования способа доставки. Исправлено.

[!] Способы доставки: ПЭК: Не передавалось количество коробок. Исправлено.

[!] Статусы: На странице admin.php?dispatch=statuses.manage возникал PHP Notice в случае отсутствия параметра type. Исправлено.

[!] Товары: Загрузчик изображений не отображался на странице редактирования товара, если у товара была только иконка, но не было изображения. Исправлено.

[!] Товары: Изображения: Перетаскивание: Тексты на различных языках в выборе изображений на странице редактирования товара отображались некорректно. Исправлено.

[!] Установка: PDO: Установка завершалась ошибкой,  если имя базы данных содержало только цифры. Исправлено.

[!] Установка: В некоторых случаях установка заканчивалась неудачей из-за неоконченной инициализации. Исправлено.

[!] Экспорт/Импорт: Данные импортировались неверно, если в CSV-файле были пробелы после разделителя. Исправлено.

[!] Экспорт/импорт: Подписчики: Нельзя было экспортировать выбранных подписчиков. Исправлено.

[!] Ядро: Детектор изменений файлов ядра: Файлы удаленных стандартных модулей могли помечаться как удаленные. Исправлено.

[!] Ядро: Документы: При печати упаковочного листа в сниппете "Примечания" отображались HTML-теги. Исправлено.

[!] Ядро: Файловый менеджер: Редактор файлов позволял загружать исполняемые файлы. Исправлено.

[!] Языки: На календаре в панели администратора на кнопке отмены всегда был текст "Cancel", независимо от выбранного языка. Исправлено.

[!] REST API: Сущность Categories: Запрос с параметрами 'item_ids' или 'category_ids' приводил к ошибке. Исправлено.

[!] {#7003} {#7242} REST API: Сущность Orders: Если у заказа была бесплатная доставка, то при обновлении этого заказа через API бесплатная доставка сбрасывалась. Исправлено.

[!] {#7114} Экспорт/Импорт: Макеты: Макеты с одинаковым dispatch объединялись при импорте. Исправлено.

[!] {#7115} {#7261} Модули: Вариации товаров [Beta]: Для опций с типом "Текст" у настраиваемого товара не сохранялись значения в корзине. Исправлено.

[!] {#7238} Модули: Защита от мошенничества: На странице заказа счетчик мошенничества выходил за пределы окна. Исправлено.

[!] {#7248} Менеджер блоков: Поля ввода настроек контента блока имели одинаковые идентификаторы тегов. Исправлено.

[!] {#7262} Модули: Расширенный импорт товаров [Beta]: Файл нельзя было импортировать по ссылке, если ссылка содержала запрос, а не имя файла. Исправлено.

[!] {#7263} Модули: SEO: Когда модуль был настроен на использование разных URL для разных языков и отображение языка в URL, то значения атрибута hreflang были неправильными. Исправлено.

[!] {#7265} Поиск: SQL: Если в адресной строке был неправильный запрос, возникала ошибка SQL. Исправлено.

[!] {#7266} Управление заказами: Детали заказа: В неадаптивной панели администратора неправильно отображалась всплывающая подсказка при наведении мыши на ID заказа. Исправлено.

[!] {#7271} Адаптивная панель администратора: E-mail вылезал за границы блока на детальной странице заказа. Исправлено.

[!] {#7278} Адаптивная панель администратора: Расширенный поиск: Поиск по дате работал некорректно. Исправлено.

[!] {#7281} Модули: Соответствие GDPR: Неправильно отображалась нижняя часть сайта на 404 странице, когда был включен модуль GDPR. Исправлено.

[!] {#7290} Ядро: Менеджер блоков: Ширина секций не всегда рассчитывалась верно. Исправлено.

[!] {#7295} Редактор шаблонов email-уведомлений: Кнопка "Добавить сниппет" дублировалась на вкладке "Сниппеты". Исправлено.

[!] {#7299} Ядро: Заказы: Тема письма отображалась некорректно при редактировании счета заказа. Исправлено.

[!] {#7303} Модули: Расширенный импорт товаров [Beta]: Характеристики импортировались только для первого товара из файла. Исправлено.

[!] {#7305} {#7310} Модули: Конструктор прайс-листов: Когда было несколько витрин, то у товаров, которые были созданы только для конкретной витрины, экспортировалась нулевая цена. Исправлено.

[!] {#7309} Дизайн: Редактировать контент: Функциональность редактирования контента на витрине не работала с включенным модулем GDPR. Исправлено.

[!] {#7324} Модули: Расширенный импорт товаров [Beta]: Ручной выбор CSV-разделителя не работал. Исправлено.

===========
Сервис-паки
===========

---------
4.8.2.SP1
---------

[!] Модули: Старая панель администратора [Не рекомендуется]: В старой неадаптивной панели администратора не работала установка модулей. Исправлено.

[!] Товары: При попытке создать товар без какой-либо категории не срабатывала проверка на заполненность поля "Категория", а в Multi-Vendor возникала ошибка 404. Исправлено.

---------
4.8.2.SP2
---------

[!] Модули: После установки модуля из архива с помощью кнопки "Загрузить и установить модуль" администратор попадал на страницу с ошибкой 404. Исправлено.
