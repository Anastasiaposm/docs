*****
4.7.2
*****

==================================
Новая функциональность и улучшения
==================================

[+] Модули: YML экспорт: Добавлена возможность выгрузки вариаций товаров.

[+] Модули: Вариации товаров [Beta]: Добавлена возможность создавать вариации без удаления существующих вариаций товара.

[+] Модули: Вариации товаров [Beta]: Добавлена возможность управлять вариациями товаров с помощью импорта и экспорта.

[+] Модули: Вариации товаров [Beta]: Добавлены настройки для отображения изображения и кода вариации в блоке со списком вариаций.

[+] Модули: Прайс-лист для Google Base: Добавлена возможность экспортировать вариации товаров.

[+] Хуки: JS: Добавлены триггеры событий для всплывающих окон.

[+] Хуки: JS: Добавлены триггеры событий для кнопок увеличения и уменьшения количества товаров.

[+] Хуки: Дизайн: Панель администратора: Добавлен новый хук для модификации количества товаров на странице редактирования товара.

[+] Хуки: Категории: Добавлены хуки для записей таблицы категорий.

[+] Хуки: Модули: Баннеры: Добавлены хуки на странице редактирования баннеров.

[+] Хуки: Модули: Теги: Добавлены новые хуки.

[+] Ядро: Добавлена совместимость с PHP 7.2.

[+] Ядро: Иконки: Добавлена поддержка библиотеки для масштабирования изображений ImageMagick 7.

=========================================
Изменения в существующей функциональности
=========================================

[*] Дизайн: Темы: На мобильных устройствах теперь можно изменять масштаб просмотра страницы.

[*] Модули: Вариации товаров [Beta]: Изменены некоторые отступы на списке вариаций и странице редактирования вариаций в панели администратора.

[*] Управление заказами: Обновлена мобильная версия страницы управления заказами.

[*] {#7089} {#7100} Опции товаров: Теперь доступность товара не отображается на детальной странице, пока не будут выбраны все обязательные опции.

==================
Исправления ошибок
==================

[!] REST API: Сущность Products: При запросе отдельного товара по ID к цене этого товара не применялась скидка. Исправлено.

[!] Валюты: В панели администратора на странице со списком валют не загружались курсы валют. Исправлено.

[!] Дизайн: В шаблонах email-уведомлений не использовался цвет фона текущей темы. Исправлено.

[!] Дизайн: Оформление заказа: Последние цифры номера кредитной карты на странице оформления заказа не было видно на мобильных устройствах. Исправлено.

[!] Дизайн: Скачиваемые товары: Неправильно отображались файлы в папке на странице загрузок. Исправлено.

[!] Дизайн: Фильтры товаров: Слайдер: В коде был лишний закрывающий тег </span>. Исправлено.

[!] Модули: CommerceML: В некоторых случаях свойство "Изготовитель" могло не импортироваться в CS-Cart, если для настройки "Значение, используемое в качестве бренда" было выбрано "Значение изготовителя". Исправлено.

[!] Модули: CommerceML: Если в импортируемом файле было много характеристик (и их было больше, чем товаров), а настройка "Разрешить импорт свойств" была выключена, то загрузка могла выполняться бесконечно. Исправлено.

[!] Модули: CommerceML: Загрузка опций в CS-Cart не выполнялась, если опции были выгружены в файл import. Исправлено.

[!] Модули: CommerceML: При загрузке файла, размер которого был больше размера, указанного в настройках PHP, возникала ошибка. Исправлено.

[!] Модули: CommerceML: При загрузки данных товара с изображениями, у существующих изображений с такими же именами удалялся альтернативный текст. Исправлено.

[!] Модули: CommerceML: При удалении основного изображения из системы учёта другое изображение не попадало в CS-Cart после выгрузки и не становилось основным. Исправлено.

[!] Модули: Pickpoint: ПВЗ на странице оформления заказа не изменялся при изменении адреса пользователя. Исправлено.

[!] Модули: Pickpoint: При обновлении списка ПВЗ Pickpoint на стороне CS-Cart не удалялись старые записи. Проблем при оформлении заказа из-за этого не возникало, но таблица в базе данных была больше, чем нужно. Исправлено.

[!] Модули: Pickpoint: При оформлении заказа неверно рассчитывалась доставка, если в ответе возвращались два сервиса доставки. Исправлено.

[!] Модули: RSS-лента: В ленте по товарам не подгружались данные о товаре. Исправлено.

[!] Модули: RetailCRM: Бесплатные товары заказа синхронизировались без скидки. Исправлено.

[!] Модули: Searchanise: Функция fn_searchanise_update_product_filter вызывалась с 2 параметрами, хотя нужно было 3. Исправлено.

[!] Модули: YML экспорт: При выгрузке товара промо-акция применялась даже в том случае, если категория из условия была выключена. Исправлено.

[!] Модули: YML экспорт: При настройке экспортируемых полей с использованием характеристик, данные поля не выгружались. Исправлено.

[!] Модули: Вариации товаров [Beta]: Для вариаций на витрине автоматически использовались SEO-имена, даже несмотря на то, что SEO-имена для вариаций нельзя редактировать. Исправлено.

[!] Модули: Вариации товаров [Beta]: Нельзя было добавить вариацию в список отложенных товаров из блока со списком вариаций, если в блоке была выключена кнопка добавления в корзину. Исправлено.

[!] Модули: Вариации товаров [Beta]: Опция, используемая вариацией, могла быть удалена. Исправлено.

[!] Модули: Вариации товаров [Beta]: Скачиваемые файлы отображались некорректно на странице загрузки файлов для нескольких заказов. Исправлено.

[!] Модули: Отзывы и комментарии: На странице "Отзывы и комментарии" товара возникали ошибки PHP Notice, если были включены модули "Вариации товаров" и "SEO". Исправлено.

[!] Модули: Почта России: Если сервис Почты России для расчета доставки был недоступен, при оформлении заказа возникали ошибки, сообщение которых не выводились. Исправлено.

[!] Модули: Почта России: Некоторые названия и варианты настроек не были переведены, так как в файлах с переводами дублировались языковые переменные. Исправлено.

[!] Модули: Прайс-лист для Google Base: При выключении у товара всех налогов, в прайс-лист для этого товара выгружалась нулевая цена. Исправлено.

[!] Модули: Прайс-лист: При генерации прайс-листа возникали ошибки. Исправлено.

[!] Модули: Рассылки: Когда в URL использовался параметр "language", возникала ошибка базы данных. Исправлено.

[!] Модули: Рассылки: Когда использовалось несколько витрин, не сохранялась витрина, выбранная для рассылки. Исправлено.

[!] Модули: Рассылки: На странице "Подписчики" у списка рассылок неверно отображалось, в каких ещё списках рассылок находится покупатель. Исправлено.

[!] Модули: Российские способы оплаты: PayMaster: Название настройки для включения отправки данных в онлайн-кассы было неверным. Исправлено.

[!] Модули: Российские способы оплаты: Яндекс.Касса: При размещение заказа в валюте, не являющейся базовой, не выполнялась оплата через Яндекс.Кассу. Исправлено.

[!] Модули: СДЭК: При изменении адреса доставки на странице оформления заказа не обновлялась карта для способа доставки СДЭК. Исправлено.

[!] Модули: СДЭК: У некоторых городов был неверно задан индекс. Исправлено. 

[!] Модули: Социальные кнопки: Если из всех "Социальных кнопок" была включена только кнопка "Яндекс", то на странице товара не было поля type.

[!] Модули: Теги: При создании нового товара в режиме "Все магазины" с категорией, не соответствующей категории-владельцу товара, возникала ошибка. Исправлено.

[!] Модули: Яндекс.Доставка: При редактировании заказа и попытке изменить ПВЗ, выбранный ПВЗ не сохранялся. Исправлено.

[!] Товары: В режиме "Все магазины" при редактировании цены товара, общего для нескольких витрин, возникала ошибка PHP Notice. Исправлено.

[!] Товары: Сортировка: Цена общего товара на определённой витрине не учитывалась при сортировке по скидке на этой витрине. Исправлено.

[!] Управление заказами: При повторном добавлении товара в заказ через всплывающее окно расширенного поиска невозможно было изменить выбранные опции у этого товара. Исправлено.

[!] Установка: При установке магазина на сервере с принудительным редиректом на HTTPS после установки невозможно было попасть в панель администратора. Исправлено.

[!] Ядро: Иконки: GD: Демо-данные: Когда витрину открывали в первый раз после установки (или после удаления сгенерированных иконок), могла возникнуть ошибка, так как некоторые изображения были слишком большими. Исправлено: большие изображения уменьшены.

[!] Ядро: ПО могло не работать на веб-сервере Apache без установленного mod_negotiation. Исправлено.

[!] {#7012} Способы оплаты: Skrill: После того, как покупатель оплачивал заказ на сайте Skrill и возвращался в магазин, возникала ошибка. Исправлено.

[!] {#7063} Дизайн: WYSIWIG: Некоторые поля были узкими, когда визуальный редактор был отключен. Исправлено.

[!] {#7072} Дизайн: Email-уведомления: Уведомления об изменении статуса заказа некорректно отображались в почтовом клиенте Mail на macOS при использовании старого механизма отправки писем. Исправлено.

[!] {#7074} Модули: Вариации товаров [Beta]: При генерации вариаций для товара, у которого не указан код, возникала ошибка PHP Notice. Исправлено.

[!] {#7077} Страницы: Период доступности: Страница не отображалась, если у её периода доступности было задано начало, но не был задан конец. Исправлено.

===========
Сервис-паки
===========

---------
4.7.2.SP1
---------

[!] Модули: Хиты продаж и товары со скидкой: Сортировка: Если в панели администратора сортировкой по умолчанию была выбрана сортировка по размеру скидки, а администратор пытался на главной странице панели администратора перейти в режим определённого магазина, возникала ошибка. Исправлено.

[!] Модули: Карта сайта для Yandex и Google: При попытке сгенерировать карту сайта мог произойти выход из панели администратора. Исправлено.

[!] Модули: Карта сайта для Yandex и Google: Файл sitemap.xml сохранялся в неверной папке. Исправлено.

---------
4.7.2.SP2
---------

[!] Языки: Переводы: После обновления до 4.7.2 SP1 некоторые настройки в панели администратора отображались на английском языке независимо от выбранного языка. Исправлено.
