*************
4.6.1 → 4.6.2
*************

==================================
Новая функциональность и улучшения
==================================

[+] Модули: Вариации товаров [Beta]: Добавлена возможность продавать вариации как цифровые товары.

[+] Модули: Вариации товаров [Beta]: Реализован учет значения настройки "Показывать товары, которых нет в наличии".

[+] Модули: Налоговые ставки РФ: Реализован новый модуль "Налоговые ставки РФ" необходимый для выполнения требований ФЗ-54.

[+] Модули: Российские способы оплаты: PayAnyWay: PayMaster: Добавлена передача информации о налогах.

[+] Хуки: Добавлен новый хук get_company_condition_post.

=========================================
Изменения в существующей функциональности
=========================================

[*] Модули: АТОЛ Онлайн: Теперь телефон клиента не будет отправляться в АТОЛ Онлайн, если указан адрес электронной почты. Это изменение позволит решить проблему с печатью чеков у 1 ОФД, когда чеки не отправлялись по причине наличия и адреса электронной почты, и телефона.

[*] Модули: Персональные данные: Добавлен модуль для подтверждения обработки персональных данных.

[*] Модули: СДЭК: 54-ФЗ: Добавлена передача информации о налогах в СДЭК для печати чеков при оплате наложенным платежом.

[*] Магазины: Со страницы "Магазины" убраны все поля поиска, кроме поиска по названию витрины.

[*] Модули: Яндекс.Доставка: 54-ФЗ: Добавлена передача информации о налогах в Яндекс.Доставку для печати чеков при оплате наложенным платежом.

==================
Исправления ошибок
==================

[!] Безопасность: Robots.txt Инструкции robots.txt можно было изменить без авторизации, если был известен URL панели администратора. Исправлено.

[!] Демо-данные: Происходила ошибка при копировании заказа с купоном SALE-20, потому что название купона должно быть sale-20. Исправлено.

[!] Дизайн: RTL: некорректное отображение календаря на фарси. Исправлено.

[!] Дизайн: Оформление заказа: Если было включено отображение налогов на странице оформления заказа, то при выборе способа доставки перед ценой со включенным налогом отображалась лишняя скобка. Исправлено.

[!] Дизайн: Товары: Количество знаков после запятой у валюты не влияло на количество знаков после запятой у рекомендованной цены товара в панели администратора. Исправлено.

[!] Дизайн: Языки c письмом справа налево: В некоторых случаях символы ) и # отображались в арабском языке не в том месте или не отображались. Исправлено.

[!] Дизайн: Языки с письмом справа налево: Текст в почтовых уведомлениях выравнивался по левой стороне. Исправлено.

[!] Журнал событий: Расширенный поиск не работал, если в поле "Пользователь" одновременно были указаны имя и фамилия. Исправлено.

[!] Маркетинг: Промо-акции: Если у промо-акции было условие "Количество товаров в корзине" или "Предварительная стоимость заказа" с вариантом "в списке" или "не в списке", то можно было указать только одно число, а все, что было после запятой, обрезалось. Исправлено.

[!] Методы доставки: FedEx: Когда стоимость доставки выставлялась не в первичной валюте магазина, стоимость доставки отображалась неверно. Исправлено.

[!] Модули: Boxberry: На детальной странице отгрузки неправильно отображался текущий статус отправления. Исправлено.

[!] Модули: eDost: Для службы доставки PickPoint не было возможности выбрать пункт выдачи на странице оформления заказа. Исправлено.

[!] Модули: Google reCAPTCHA: Ссылка на страницу Google в настройках модуля устарела и вела на страницу с ошибкой 404. Исправлено.

[!] Модули: RetailCRM [Beta]: YML-файл для RetailCRM создавался с полем purchase_price вместо purchasePrice. Исправлено.

[!] Модули: RetailCRM [Beta]: Если в заказе была промо-акция, дающая код купона, то при синхронизации такого заказа клиент получал лишние почтовые уведомления. Исправлено.

[!] Модули: RetailCRM [Beta]: Если заказ в RetailCRM был создан с некоторыми незаполненными полями, то при синхронизации могла возникнуть ошибка. Исправлено.

[!] Модули: RetailCRM [Beta]: Если заказ в RetailCRM не имеет email адреса покупателя, но в профиле покупателя email адрес указан, то заказ не импортировался. Исправлено.

[!] Модули: RetailCRM [Beta]: Логирование синхронизации с RetailCRM не работало, если родительская директория для лога не была создана. Исправлено.

[!] Модули: RetailCRM [Beta]: Настройки модуля не открывались при указании доступов к не существующему аккаунту. Исправлено.

[!] Модули: RetailCRM [Beta]: Один магазин в RetailCRM мог быть связан с несколькими витринами в CS-Cart, что приводило к проблемам с синхронизацией заказов. Исправлено.

[!] Модули: YML экспорт: Если скрыть или выключить характеристики, то при генерации YML прайс-листа появлялись нотисы об ошибках. Исправлено.

[!] Модули: Вариации товаров [Beta]: Экспорт/Импорт: Импорт завершался ошибкой, если в импортируемом файле было поле «Variation code», и присутствовали простые товары. Исправлено.

[!] Модули: Обратный звонок: Невозможно ввести номер телефона на форме обратного звонка с мобильных устройствах с Android. Исправлено.

[!] Модули: Определение местоположения: При заходе на клиента на сайт мог не определиться его город (например, проблема возникала для Санкт-Петербурга). Исправлено.

[!] Модули: СДЭК: Если был включен модуль СДЭК, то ссылка для печати квитанции отображалась на странице у каждой отгрузки, даже если она была отправлена не через СДЭК. Исправлено.

[!] Модули: СДЭК: Статус доставки при обновлении не соответствовал статусу заказа в СДЭК. Исправлено.

[!] Модули: Самовывоз: На странице оформления заказа при изменении региона не обновлялась карта. Исправлено.

[!] Модули: Яндекс.Доставка: Если время работы точки самовывоза разбивалось на две части обеденным перерывом, то режим работы точки самовывоза на странице заказа отображался неправильно. Исправлено.

[!] Опции: Запрещенные комбинации: Если у товара была опция с типом "Радиогруппа", и все варианты этой опции были запрещены, то товар нельзя было добавить в корзину. Исправлено.

[!] Оформление заказа: Если имя, фамилия, или телефон отсутствовали в профиле и не заполнялись при оформлении заказа, то при попытке размещения заказа возникала ошибка базы данных. Исправлено.

[!] Оформление заказа: Опции: Товар с запрещенной опцией невозможно было добавить в заказ через панель администратора. Исправлено.

[!] Оформление заказа: Товары с бесплатной доставкой могли быть куплены при отсутствии доступных способов доставки. Исправлено.
[!] Почта: Письма могли отправляться в некорректной кодировке с "битым" текстом. Исправлено.

[!] Редактирование заказа: Добавление товаров: Если у товара не было изображения, то при вводе названия товара вместо изображения отображалась пустая область. Исправлено.

[!] Редактор документов: Счет: Поля профиля: Если у поля профиля в названии поля был символ "." или "-", то это поле неправильно отображалось на счете. Исправлено.

[!] Темы: Перегрузка настроек: При активации темы из-под администратора витрины настройки, которые не могли быть перегружены текущим администратором, отображались в числе перегружаемых. Исправлено.

[!] Товары: Макеты: Если администратор изменял содержимое блока с типом заполнения "Вручную" у конкретного товара на вкладке "Макеты", то эти изменения сохранялись только для выбранного языка. Исправлено.

[!] Ядро: API: Не работала проверка на существование товара или категории в базе данных. Исправлено.

[!] {#6054} Ядро: Сессия: В файле Session.php могла возникать ошибка PHP Notice. Исправлено.

[!] {#6747} Модули: Платежи через PayPal: Кавычки и некоторые другие символы в названиях товаров неверно отображались на стороне PayPal при оплате через PayPal Standard. Исправлено.

[!] {#6806} Дизайн: Изображения: Анимация при загрузке изображений обрезалась и была смещена. Исправлено.

[!] {#6816} Корзина: Страны: Стоимость доставки рассчитывалась неправильно если были лишние пробелы в индексе. Исправлено.

[!] {#6820} Модули: Бонусные баллы: При расчете количества баллов, которые даются за покупку товаров или тратятся на покупку товара, всегда учитывались скидки, независимо от настроек модуля. Исправлено.

[!] {#6825} Ядро: Страны: При указании определённых параметров возникала ошибка запроса. Исправлено.

[!] {#6839} Модули: Вариации товаров [Beta]: При установленном модуле отсутствовало изображение бренда на странице товара. Исправлено.

[!] {#6841} Экспорт/Импорт: Подписчики: Подписчики не экспортировались в CSV-файл. Исправлено.

