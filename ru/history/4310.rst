4.3.9 → 4.3.10
--------------

    [+] — Новое

    [*] — Изменение

    [!] — Исправлена ошибка


[+] Хуки: Добавлен хук для изменения рассчитанной стоимости доставки.

[+] Хуки: Добавлен хук для изменения фильтров.

[+] Хуки: Добавлен хук для изменения информации об оплате в заказе.

[+] Хуки: Модули: Добавлены хуки в модуле “Бонусные баллы”.

[+] Хуки: Дизайн: Добавлен хук вокруг иконки сайта.

[+] Хуки: Пункты назначения: Добавлен хук в начале функции ``fn_update_destination``.

[+] Теперь если включить/отключить API-доступ пользователю, информация об этом придет в уведомлении.

[+] Модули: YML экспорт: Добавлены настройки, позволяющие задать минимальную и максимальную цену экспортируемых товаров.


[*] API: Проверка авторизации перенесена в функцию ``handleRequest``.

[*] Дизайн: Заказы: Хук ``tabs_extra`` вынесен из формы.

[*] Способы доставки: UPS: Обновлен список служб доставки.


[!] Модули: Прикрепленные файлы: После удаления прикрепленного файла нельзя было добавить новый файл, не обновив перед этим страницу. Исправлено.

[!] Модули: Хиты продаж: Производительность: Если для блока “Товары” с типом заполнения “Аналогичные товары” включить настройку “Показывать только товары в наличии”, то сервер MySQL сильно нагружал процессор. Исправлено.

[!] Модули: Подарочные сертификаты: Поле для почтового индекса было слишком коротким. Исправлено.

[!] Модули: Платежи через PayPal: Можно было не заполнять обязательное поле “ID аккаунта” при использовании способа оплаты PayPal Express Checkout и включенной настройке "Использовать In-Context checkout". Исправлено.

[!] Модули: Конструктор прайс-листов: Использование HTML-тегов в символах валюты или использование специальных символов (&nbsp;) в качестве разделителя тысяч могло привести к ошибкам при попытке открыть сгенерированный XLSX-файл в Excel. Исправлено.

[!] Модули: Searchanise: Виджет быстрого поиска не работал на странице товаров продавца. Исправлено.

[!] Модули: Searchanise: Товары выключенных компаний могли появиться в результатах поиска. Исправлено.

[!] Модули: Searchanise: Не выставлялась сортировка по умолчанию после неудачного запроса к Searchanise. Исправлено.

[!] Модули: Searchanise: На странице результатов поиска не использовались фильтры Searchanise. Исправлено.

[!] Модули: SEO: Невозможно было открыть страницы объектов с SEO-именами на витрине, для которой не был доступен язык витрины по умолчанию. Исправлено.

[!] Модули: SEO: Модуль был включен по умолчанию, даже если на сервере была выключена перезапись URL. Исправлено.

[!] Модули: SMS-уведомления: Уведомления не отправлялись, если было настроено отправление сообщений только для определенных способов доставки. Исправлено.

[!] Модули: Расположение магазина: В модуле не использовался API-ключ Google Карт. Исправлено.

[!] Модули: Деловые линии: При расчете стоимости доставки не учитывались габариты товара. Исправлено.

[!] Модули: Почта России: Если вес заказа был меньше 2 кг, доставка рассчитывалась как для письма. Исправлено.

[!] Модули: Российские способы оплаты: При оплате заказа через WebMoney могла появиться ошибка “Несоответствие хэша”. Исправлено.

[!] Модули: СДЭК: Неправильно работала кнопка “Обновить статусы”. Исправлено.

[!] Модули: Яндекс.Маркет: Возвращался неправильный срок доставки. Исправлено.

[!] Модули: CommerceML: При обмене с большим количеством товаров не загружались характеристики и описание товара. Исправлено.

[!] Модули: YML экспорт: При импорте поля “Варианты доставки/Дней” (order before) принимались только числовые значения. Исправлено.

[!] Модули: YML экспорт: При одинаковых значениях YML unit могли быть удалены варианты у неподходящих характеристик. Исправлено.

[!] Модули: YML экспорт: При изменении YML unit у варианта характеристики создавался новый вариант характеристики. Исправлено.

[!] Модули: YML экспорт: Не отображалась единица измерения YML unit в фильтрах товаров. Исправлено.

[!] Категории: В редких случаях название товара могло не отображаться на странице товара из-за того, что категория не была удалена из таблицы ``cscart_products_categories``. Исправлено.

[!] Ядро: API: Отключение учетной записи пользователя не отключало возможности использования API. Исправлено.

[!] Ядро: Кэш: Опции товаров: Кэш товара не очищался после удаления глобальной опции у товара. Исправлено.

[!] Ядро: Выключенные характеристики отображались в форме расширенного поиска. Исправлено.

[!] Ядро: Исправлены ошибки в функциях ``fn_top_menu_form`` и ``fn_top_menu_standardize``.

[!] Ядро: Загрузка файлов: Возникала ошибка, если общий размер всех файлов, загружаемых за один раз, был больше размера, разрешенного в  ``upload_max_filesize``. Исправлено.

[!] Ядро: Обновление: Проверка прав на измененные файлы могла привести к ошибкам, если измененный файл был недоступен или не существовал. Исправлено.

[!] Ядро: Обновление: При обновлении права на точки входа могли поменяться на 0666/0777, и магазин становился недоступен, если на сервере использовался suPHP. Исправлено.

[!] CS-Cart: Языки: Даже если язык не был доступен для витрины, его можно было сделать языком витрины по умолчанию. Исправлено.

[!] CS-Cart: Некоторые URL были неправильными, если панель администратора работала по HTTPS, а витрина — нет. Исправлено.

[!] Дебаггер: Редактирование контента: При редактировании контента одновременно с включенным дебаггером возникали критические ошибки PHP. Исправлено.

[!] Дизайн: Панель администратора: Заказы: Информация о товарах в заказе могла появиться под изображениями. Исправлено.

[!] Дизайн: Панель инструментов: Переключение языка на Панели инструментов не влияло на названия статусов в разделе “Последние заказы”. Исправлено.

[!] Дизайн: Изображения: На iPhone и iPad изображения не открывались во всплывающем окне и не могли быть сохранены. Исправлено.

[!] Дизайн: Макеты: При добавлении собственной всплывающей подсказки в настройки секции возникала ошибка. Исправлено.

[!] Дизайн: Макеты: Фильтры: Настройки фильтра товаров в свойствах блока могли открыться на новой странице вместо всплывающего окна. Исправлено.

[!] Дизайн: Заказы: Для нового поиска не работает пагинация. Исправлено.

[!] Дизайн: Товары: Вкладки товаров: Если содержимое вкладки открывалось во всплывающем окне, то кнопка закрытия окна подсвечивалась по умолчанию. Исправлено.

[!] Дизайн: Темы: Basic: Не загружался Редактор тем. Исправлено.

[!] Дизайн: Темы: Responsive: Строка навигации: Строка навигации показывалась поверх родительского блока с настройкой “Выравнивание содержимого: Слева”.

[!] Дизайн: WYSIWYG: Встраиваемые видео не адаптировались под экраны мобильных устройств. Исправлено.

[!] Дизайн: Корзина: Кнопки на странице корзины отображались неправильно, если был включен модуль Яндекс.Доставка. Исправлено.

[!] Дизайн: Модули: Email-маркетинг: Форма подписки отображалась некорректно. Исправлено.

[!] Цифровые товары: Модули: Платежи через PayPal: Если оформить заказ на цифровой товар в магазине, но отменить заказ на странице оплаты, могли возникнуть PHP-нотисы. Исправлено.

[!] Экспорт/Импорт: Товары: Изображения для вариантов опций не импортировались по URL. Исправлено.

[!] Характеристики: Страница товара: При выборе страницы на вкладке сбрасывалось число записей на странице. Исправлено.

[!] Опции: Файл: Не отображалось никаких сообщений, если для опции с типом “Файл” одновременно пытались загрузить несколько файлов, суммарный размер которых был больше, чем разрешено сервером. Исправлено.

[!] Управление заказами: Отгрузки: Нельзя было создать отгрузку без указания номера отслеживания. Исправлено.

[!] Заказы: В данных о заказе количество купленных экземпляров товара не могло быть больше 65535. Исправлено.

[!] Способы оплаты: SagePay: Информация о налогах не отправлялась в платежную систему. Исправлено.

[!] Phar: Неправильно создавались tgz-архивы. Исправлено.

[!] Фильтры товаров: Цена: Если в символе валюты использовался HTML-код, невозможно было вручную задать максимальную цену. Исправлено.

[!] Промо-акции: При выборе характеристики товара с типом “Флажок: Несколько” во вкладке “Условия” в поле для выбора значения характеристики не работал выпадающий список. Исправлено.

[!] Промо-акции: При использовании условия “Код купона” с выбором “в списке” не работали коды купонов с пробелами. Исправлено.

[!] Redis: Добавлена возможность задавать порт.

[!] Способы доставки: Товары неправильно перераспределялись по коробкам с учетом максимального веса коробки. Исправлено.

[!] {#6332} Ядро: Сессия: Неудачная проверка валидности сессии могла привести к ошибкам, если на сервере использовался PHP 7. Исправлено.

[!] {#6378} Дизайн: Галерея изображений товара: Иконки выходили за край экрана на мобильных устройствах, если ширина экрана была меньше настройки “Ширина иконки на детальной странице товара”. Исправлено.

[!] {#6381} Дизайн: Панель администратора: После выполнения AJAX-запроса не открывалась секция “Расширенный поиск”. Исправлено.

[!] {#6401} Модули: Штрих-коды: Неправильно распознавались сгенерированные штрих-коды. Исправлено.

[!] {#6411} Ядро: База данных: Не работал механизм повторного подключения после обрыва соединения с базой данных. Исправлено.

[!] {#6415} Ядро: База данных: Наличие цифр в префиксах таблиц могло привести к ошибкам. Исправлено.

[!] {#6416} Дизайн: Темы: Responsive: Вертикальное меню: По умолчанию меню было открыто на мобильных устройствах. Исправлено.

[!] {#6425} Оформление заказа: Доставка: При изменении количества купленных экземпляров товара могло неправильно увеличиться количество коробок. Исправлено.  

[!] {#6425} Оформление заказа: Доставка: Модификаторы цен опций не применялись к цене коробки. Исправлено.

[!] {#6426} Ядро: JS: Микроформат "cm-ajax-content-input" не работал одновременно с "cm-value-integer" или "cm-value-decimal". Исправлено.

[!] {#6429} Ядро: Функция “fn_get_dir_contents” неправильно работала с относительными путями. Исправлено.

[!] {#6435} Ядро: После обновления могла возникнуть ошибка в базе данных, если в сессии, созданной в 4.3.8, сохранились товары. Исправлено.

[!] {#6443} Способы оплаты: AuthorizeNet.Aim: Отсутствовал код ошибки AVS для случая, когда банком-эмитентом карты является банк не из США. Исправлено.

[!] {#6447} Модули: Подарочные сертификаты: Существовала возможность не вводить адрес при покупке подарочного сертификата. Исправлено.

[!] {#6454} Дизайн: Редактор тем: Некоторые иконки отображались неверно, когда Редактор тем был включен. Исправлено.

[!] {#6454} Дизайн: Редактор тем: Редактор тем не был адаптирован для работы с языками с письмом справа налево. Исправлено.

[!] {#6483} Пользователи: Покупатели: Поле “Имя” в профиле пользователя могло стать пустым после оформления заказа. Исправлено.
