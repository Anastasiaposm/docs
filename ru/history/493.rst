*****
4.9.3
*****

==================================
Новая функциональность и улучшения
==================================

[+] Дизайн: Шаблоны email-уведомлений: Документы: Добавлена возможность вставки документов в уведомления через редактор.

[+] Дизайн: Шаблоны email-уведомлений: Документы: Добавлена возможность перехода к редактированию сниппетов и документов со страницы редактирования уведомления.

[+] Дизайн: Шаблоны email-уведомлений: Документы: На страницу редактирования документа добавлен список email-уведомлений, в которых он используется.

[+] Модули: Google reCAPTCHA: Добавлена возможность задать в настройках страны, для которых вместо проверки от Google будет использоваться встроенная проверка (ввод символов).

[+] Настройки: Журнал событий: Добавлена новая настройка, которая позволяет автоматически удалять записи в журнале спустя определённое количество дней.

[+] Панель администратора: В мобильную версию добавлена строка поиска.

[+] Товары: Детальная страница: Для мобильных устройств реализован механизм переключения картинок жестами.

[+] Установка: Добавлена проверка на валидность table_prefix.

[+] Хуки: Панель администратора: Пункты назначения (тарифные зоны): Добавлен хук для изменения/добавления полей в область названия.

[+] Центр обновлений: Добавлена возможность пропускать резервное копирование файлов и базы данных при установке обновлений модулей.

[+] Ядро: JavaScript: Добавлена возможность влиять на скорость прокрутки при использовании функции scrollToElm.

[+] Ядро: Добавлена возможность работы на веб-сервере Apache 2.4.

[+] Multi-Vendor: Модули: Тарифные планы для продавцов: Добавлена настройка, которая позволяет исключить налоги из расчёта комиссии.

=========================================
Изменения в существующей функциональности
=========================================

[*] Модули: Товары@mail.ru: Модуль удалён в связи с закрытием сервиса.

[*] Хуки: Каталог: apply_option_modifiers_get_option_modifiers: Добавлена возможность получения дополнительных модификаторов цен и их изменения.

[*] Экспорт/Импорт: Продавцы: Поле “Факс” удалено из списка доступных полей для экспорта/импорта, поскольку у продавца теперь нет такого поля.

[*] Multi-Vendor: Изменён цвет панелей администратора продавцов.

[*] Multi-Vendor Plus: Модули: Общие товары для продавцов (Beta): Теперь на списке товаров рядом с общим товаром отображается цена самого дешёвого товарного предложения.

==================
Исправления ошибок
==================

[!] Витрины: Иконка замка не прокручивалась в выпадающем списке выбора витрины в панели администратора. Исправлено.

[!] Группы пользователей: Привилегии: Витрины: Можно было менять статус витрины, даже если у вашей группы пользователей не было таких прав. Исправлено.

[!] Группы пользователей: Привилегии: администратор с привилегией на просмотр баннеров не мог просматривать баннеры. Исправлено.

[!] Дизайн: В консоли появлялись ошибки при прокрутке слайдеров с мобильных устройств. Исправлено.

[!] Дизайн: Всплывающие подсказки: В мобильных браузерах, основанных на Webkit, подсказки отображались в неправильном месте. Исправлено.

[!] Дизайн: Модули: Подарочные сертификаты: Параметр "Цвет" у статуса сертификата ни на что не влиял. В связи с этим, параметр был удалён.

[!] Дизайн: Панель администратора: В шаблонах были небольшие недочёты. Исправлено.

[!] Дизайн: Панель администратора: Неправильно отображалось всплывающее окно после установки. Исправлено.

[!] Дизайн: Языки с письмом справа налево: Если страницу без хлебных крошек открыть при выбранном арабском языке, возникала ошибка. Исправлено.

[!] Импорт: При повторном импорте существующих файлов (для цифровых товаров) создавались дублирующие ссылки. Исправлено.

[!] Модули: CommerceML: На новых версиях PHP (например, 7.1.25) могла не работать выгрузка заказов в 1С и другие системы учёта — возникала ошибка из-за неправильного типа переменной. Исправлено.

[!] Модули: RetailCRM (Beta): Статус заказа в RetailCRM не изменялся, если на стороне магазина статус менялся с "Открытого" на "Незавершенный". Исправлено.

[!] Модули: SEO: В некоторых случаях настройка "Использовать один URL для всех языков" работала некорректно. Исправлено.

[!] Модули: SEO: Двойное URL-кодирование приводило к неверному запросу. Исправлено.

[!] Модули: SEO: Некоторые символы польского алфавита не преобразовывались в соответствующие символы английского алфавита в ссылках.  Исправлено.

[!] Модули: Вариации товаров (Beta): CommerceML: После импорта товаров с вариациями, вариации не отображались на странице редактирования товара. Исправлено.

[!] Модули: Вариации товаров: Характеристики: При определённых условиях не отображались характеристики у вариаций. Исправлено.

[!] Модули: Комбинации товаров: При редактировании заказа с комбинацией товаров возникали ошибки PHP notice. Исправлено.

[!] Модули: ПЭК: У ПЭК изменился адрес API, и из-за этого нельзя было настроить службу и получить стоимость доставки. Исправлено.

[!] Модули: Платежи через PayPal: В зависимости от настроек cURL на сервере, статусы заказов, оплаченных через PayPal, не менялись автоматически даже после получения IPN. Исправлено.

[!] Модули: Платежи через PayPal: Данные 3D Secure не передавались при проведении платежей через PayPal Pro. Исправлено.

[!] Модули: Платежи через PayPal: Если в панели администратора использовалось защищенное соединение, то при настройке способа оплаты с помощью кнопки "Подключиться к PayPal" отображалось предупреждение о безопасности. Исправлено.

[!] Модули: Подтверждение на обработку персональных данных (152-ФЗ): Сообщение об ошибке о незаполненном поле отображалось не в том месте. Исправлено.

[!] Модули: Почта России: Стоимость доставки рассчитывалась без учёта НДС. Исправлено.

[!] Модули: Премодерация данных продавцов: Вариации товаров (Beta): При массовом утверждении товаров, утверждались только вариации последнего товара. Исправлено.

[!] Модули: Простое оформление заказа (Beta): В автозаполнение города подгружались не все возможные города. Исправлено.

[!] Модули: Простое оформление заказа (Beta): В браузере Safari одновременно подсвечивались несколько способов доставки и оплаты. Исправлено.

[!] Модули: Простое оформление заказа (Beta): Дополнительный сбор не применялся на странице оформления заказа при смене способа оплаты. Исправлено.

[!] Модули: Простое оформление заказа (Beta): Если клиент ввёл город доставки и не выбрал его явно из списка, то город не сохранялся в заказе. Исправлено.

[!] Модули: Простое оформление заказа (Beta): Индекс, введённый на странице оформления заказа, не сохранялся в заказе. Исправлено.

[!] Модули: Простое оформление заказа (Beta): Калькулятор стоимости доставки eDost.ru: Не сохранялся пункт самовывоза в заказе. Исправлено.

[!] Модули: Простое оформление заказа (Beta): Не рассчитывалась стоимость доставки Почтой России в Барнаул из-за некорректного индекса у города. Исправлено.

[!] Модули: Простое оформление заказа (Beta): Невозможно было изменить пункт самовывоза Boxberry на странице оформления заказа. Исправлено.

[!] Модули: Простое оформление заказа (Beta): При размещении заказа адрес плательщика перезаписывался адресом доставки. Исправлено.

[!] Модули: Простое оформление заказа (Beta): Стоимость доставки не менялась на странице оформления заказа при выполнении условий промо-акции. Исправлено.

[!] Модули: Расширенный импорт товаров: Импорт не работал, если один из промежуточных узлов, указанных в настройке "Целевой узел XML" пресета, повторялся в файле более одного раза. Исправлено.

[!] Модули: Расширенный импорт товаров: Не работал импорт, если расширение загружаемого файла было в верхнем регистре. Исправлено.

[!] Модули: Расширенный импорт товаров: Не удавалось выполнить импорт на списке пресетов. Исправлено.

[!] Модули: Российские способы оплаты: PayAnyWay: Номенклатура передавалась в сервис с некорректными символами в названии товара. Исправлено.

[!] Модули: Российские способы оплаты: ВсёВкредит: Если витрина была открыта через зашифрованное соединение (HTTPS), то виджет сервиса не загружался при оплате. Исправлено.

[!] Модули: Российские способы оплаты: Яндекс.Деньги: При оплате через Yandex p2p происходила критическая ошибка. Исправлено.

[!] Модули: Служба доставки — СДЭК: В сообщении об отгрузке была неверная ссылка на сайт для отслеживания посылки.

[!] Модули: Служба доставки — СДЭК: Можно было оформить заказ, не выбрав ПВЗ. Исправлено.

[!] Модули: Экспорт в Яндекс.Маркет: При создании прайс-листа, если количество товаров превышало значение ITERATION_OFFERS, сбивалась нумерация категорий. Исправлено.

[!] Модули: Яндекс.Доставка: Boxberry: В заказе с выбранной доставкой "Яндекс.Доставка" отображалась карта Boxberry. Исправлено.

[!] Модули: Яндекс.Доставка: При создании отгрузки с нулевой стоимостью доставки происходила ошибка. Исправлено.

[!] Модули: Яндекс.Доставка: При создании отгрузки сервису не передавались имя и фамилия, невозможно было обновить данные о покупателе. Исправлено.

[!] Модули: Яндекс.Доставка: Расчёт стоимости доставки приводил к критической PHP-ошибке, если в настройках способа доставки не было выбрано ни одной службы доставки. Исправлено.

[!] Модули: Яндекс.Доставка: Редактирование заказа: При создании или редактировании заказа в панели администратора не отображались пункты самовывоза. Исправлено.

[!] Панель администратора: Дизайн: Заказы: Строка с названием способа доставки переносилась на новую строку через каждое слово. Исправлено.

[!] Панель администратора: Меню: Часть пунктов в меню не была отмечена иконкой принадлежности к модулю. Исправлено.

[!] Поля профиля: У поля Область/район вместо типа поля отображался PHP warning. Исправлено.

[!] Редактирование заказов: Кнопки сохранения данных пользователя отсутствовали в мобильном режиме. Исправлено.

[!] Редактирование заказов: Поле ввода цены имело слишком маленький размер. Исправлено.

[!] Редактор файлов: Редактор не работал при выбранном японском языке. Исправлено.

[!] Способы доставки: При логировании ошибок при расчете стоимости доставки могли возникать предупреждения PHP. Исправлено.

[!] Товары: Категории: При обновлении данных товара его главная категория сбрасывалась. Исправлено.

[!] Товары: При обновлении данных о товаре в панели администратора сбрасывалась его позиция в категории. Исправлено.

[!] Товары: При удалении файла у цифрового товара происходила критическая ошибка PHP. Исправлено.

[!] Ядро: JavaScript: ceAccordeon: Плагин не использовал стандартную функцию scrollToElm. Исправлено.

[!] Ядро: REST API: У сущностей "Languages", "Payments", "Settings", "Shippings", "Statuses", "Taxes" неправильно возвращался параметр "total_items". Исправлено.

[!] JS: Неверно генерировалось имя JS-события для AJAX-ссылок. Исправлено.

[!] Multi-Vendor: Дизайн: Блоки: Когда у блока "Категории продавца" был шаблон "Текстовые ссылки" или "Многоколоночный список", то ссылки на категории уводили покупателя из микромагазина продавца в главный магазин. Исправлено.

[!] Multi-Vendor: Модули: Тарифные планы для продавцов: Администратор магазина мог создать товар в категории, недоступной для выбранного продавца. Исправлено.

[!] Multi-Vendor: Модули: Тарифные планы для продавцов: Символ валюты отображался с html кодом на странице тарифных планов. Исправлено.

[!] Multi-Vendor: Поля профиля: Если при создании поля профиля продавца была какая-то ошибка (например, был введён неподдерживаемый символ), то администратора перенаправляло на страницу создания поля профиля покупателя/администратора. Исправлено.

[!] Multi-Vendor: Шаблоны email-уведомлений: Продавец получал уведомления о смене статуса не на том языке, который выбрал, а на том, который был выбран в панели администратора. Исправлено.

[!] Multi-Vendor Plus: Заказы: Редактирование заказа: Если был включен модуль "Привилегии продавцов", то при переходе на страницу редактирования заказа возникала ошибка PHP notice. Исправлено.

[!] Multi-Vendor Plus: Модули: Общие товары для продавцов (Beta): В корзине нельзя было изменить количество обычных (необщих) товаров, добавленных туда. Исправлено.

[!] Multi-Vendor Plus: Модули: Общие товары для продавцов (Beta): Выбор категорий был недоступен для продавцов при создании обычного товара. Исправлено.

[!] Multi-Vendor Plus: Модули: Общие товары для продавцов (Beta): Для настраиваемых товаров, создаваемых продавцами, нельзя было создать вариации. Исправлено.

[!] Multi-Vendor Plus: Модули: Общие товары для продавцов (Beta): Информация о бонусных баллах не отображалась на страницах обычных товаров и товарных предложений. Исправлено.

[!] Multi-Vendor Plus: Модули: Общие товары для продавцов (Beta): На странице товарного предложения на витрине дублировалось главное изображение, если у общего товара было задано несколько изображений. Исправлено.

[!] Multi-Vendor Plus: Модули: Общие товары для продавцов (Beta): Новые категории не появлялись в мини-магазине продавца, если он начинал продавать общие товары из этих категорий. Исправлено.

[!] Multi-Vendor Plus: Модули: Общие товары для продавцов (Beta): Оплата напрямую продавцам: Продаваемые товары нельзя было купить с помощью способов оплаты продавцов. Исправлено.

[!] Multi-Vendor Plus: Модули: Общие товары для продавцов (Beta): Товары нельзя было преобразовать в общие через массовое редактирование. Исправлено.

[!] Multi-Vendor Plus: Модули: Общие товары для продавцов (Beta): Фильтры товаров не работали при поиске по товарным предложениям продавцов. Исправлено.

[!] Multi-Vendor Plus: Модули: Оплата напрямую продавцам: Платежи через PayPal: Способы оплаты, созданные с помощью кнопок "Подключиться к PayPal" всегда назначались владельцу магазина, а продавца после настройки метода перенаправляло в главную панель администрирования вместо своей панели. Исправлено.

[!] Multi-Vendor Plus: Модули: Привилегии продавцов: Если администратор с назначенной группой пользователей редактировал группу продавцов, то тип группы продавцов менялся на "Покупатель". Исправлено.

[!] Multi-Vendor Plus: Модули: Тарифные планы для продавцов: Комиссии для категорий: При расчете комиссии по категориям стоимость доставки облагалась комиссией категории, а должна была облагаться комиссией плана. Исправлено.

===========
Сервис-паки
===========

---------
4.9.3.SP1
---------

[!] Дизайн: Вертикальная прокрутка страницы на мобильном устройстве не работала, если начальной точкой прокрутки был слайдер. Исправлено.
