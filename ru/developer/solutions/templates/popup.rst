************************
Pop-up (вплывающие окна)
************************

.. contents:: Содержание
    :local: 
    :depth: 3

Используйте примеры ниже, чтобы создавать всплывающие окна в своих блоках и шаблонах.

Чтобы проверить примеры, создайте простой HTML блок с поддержкой SMARTY любой части сайта.

1. Открываем блок в всплывающем окне по клику
---------------------------------------------

Ссылка, которая откроет pop-up блок должна иметь классы:

*   ``cm-dialog-opener``

*   ``cm-dialog-auto-size`` — размер окна будет соответствовать содержимому.

ID блока который необходимо открыть задаётся параметром ``data-ca-target-id``. 

ID блока должен быть уникальным.

Пример:

.. literalinclude:: files/popup_div_by_link.tpl
    :language: html

Результат клика по ссылке:

.. fancybox:: img/popup_simple.png
    :alt: Popup Ajax


2. Любую страницу в pop-up окне (по Ajax)
-----------------------------------------

Можно открыть любую страницу или шаблон контроллера в pop-up окне.

Также, как в примере выше, только дополнительно указывается ``href`` c URL необходимой страницы.

Пример SMARTY блока:

.. literalinclude:: files/popup_ajax_by_link.tpl
    :language: smarty

Результат клика по ссылке:

.. fancybox:: img/popup_ajax.png
    :alt: Popup Ajax



3. Используем готовый SMARTY шаблон (common/popupbox.tpl)
---------------------------------------------------------

В CS-Cart есть заготовка для открытия всплывающих окон, она расположена в папке темы:
`
``/design/themes/[название_темы]/templates/common/popupbox.tpl``

Данная заготовка позволяет быстро создавать Pop-up окна. Её используют другие шаблоны темы и дополнительные модули.

Пример SMARTY блока:

.. literalinclude:: files/popup_ajax_by_common_simple.tpl
    :language: smarty

Результат клика по ссылке:

.. fancybox:: img/popup_common_simple.png
    :alt: Popup Ajax


4. Всплывающее окно с формой
----------------------------

Сделаем форму, которая будет открываться по клику на ссылку. Форма будет отправлять данные на ваш контроллер используя Ajax. 

Пример SMARTY блока:

.. literalinclude:: files/popup_ajax_by_common_hard.tpl
    :language: smarty

Результат клика по ссылке:

.. fancybox:: img/popup_common_hard.png
    :alt: Popup Ajax


5. Открыть всплывающее окно при загрузке страницы
-------------------------------------------------

Добавьте блоку класс ``cm-dialog-auto-open``, тогда pop-up откроется при открытии страницы. 

Чтобы окно не открывалось каждый раз, добавляйте данный класс при особых условиях, например, в зависимости от параметра в URL (или от сессии посетителя).

Пример SMARTY блока, окно будет открыто если в URL есть параметр ``?open_love=Y``:

.. literalinclude:: files/popup_ajax_by_url.tpl
    :language: smarty

Результат клика по ссылке:

.. fancybox:: img/popup_auto_open.png
    :alt: Popup Ajax


6. Как сделать уникальные ID для всплывающих окон
-------------------------------------------------

Ссылки открывают всплывающие окна по ID , соответственно у каждого окна должен быть уникальный ID . Если будет несколько блоков с одинаковым ID, то это приведёт к одновременному открытию двух и более окон.

Если вы добавляете всплывающее окно через блок, то можно использовать массив ``{$block}``, который содержит информацию о блоке, в том числе ``{$block.blocl_id}``.

Распечатаёте в своём SMARTY блоке ``{$block|fn_print_r}``

Вы увидите:

.. fancybox:: img/popup_block_print_r.png
    :alt: Popup Ajax

Используйте значение для id из массива, например, ``{$block.blocl_id}``.

Пример:

.. literalinclude:: files/popup_ajax_by_link_uniq_id.tpl
    :language: smarty


